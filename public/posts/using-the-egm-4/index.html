<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Using the EGM-4 &amp; open-egm4 software | morgan docs</title>
<meta name="keywords" content="">
<meta name="description" content="
  Backup your data regularly.  The EGM-4&rsquo;s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten.


  You are responsible for your data. Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally.


  Don&rsquo;t get water in the gas lines. If you do, it might enter the IRGA itself and damage it. It&rsquo;s like $15,000 to replace.

Introduction
The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.">
<meta name="author" content="">
<link rel="canonical" href="https://docs.mor-gan.com/posts/using-the-egm-4/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.dc9d8bc0b516382c12a77323c16a97d5f0e9be0bff6b463a8acbfbd83f95dcee.css" integrity="sha256-3J2LwLUWOCwSp3MjwWqX1fDpvgv/a0Y6isv72D&#43;V3O4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://docs.mor-gan.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://docs.mor-gan.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://docs.mor-gan.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://docs.mor-gan.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://docs.mor-gan.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://docs.mor-gan.com/posts/using-the-egm-4/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>


<meta name="theme-color" content="#FAFAF8" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#1A1D1B" media="(prefers-color-scheme: dark)">


<meta name="color-scheme" content="light dark">


<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true
        },
        options: {
            skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><meta property="og:url" content="https://docs.mor-gan.com/posts/using-the-egm-4/">
  <meta property="og:site_name" content="morgan docs">
  <meta property="og:title" content="Using the EGM-4 & open-egm4 software">
  <meta property="og:description" content=" Backup your data regularly. The EGM-4’s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten. You are responsible for your data. Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally. Don’t get water in the gas lines. If you do, it might enter the IRGA itself and damage it. It’s like $15,000 to replace. Introduction The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-01T15:25:00-06:00">
    <meta property="article:modified_time" content="2026-02-01T15:25:00-06:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Using the EGM-4 &amp; open-egm4 software">
<meta name="twitter:description" content="
  Backup your data regularly.  The EGM-4&rsquo;s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten.


  You are responsible for your data. Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally.


  Don&rsquo;t get water in the gas lines. If you do, it might enter the IRGA itself and damage it. It&rsquo;s like $15,000 to replace.

Introduction
The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://docs.mor-gan.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Using the EGM-4 \u0026 open-egm4 software",
      "item": "https://docs.mor-gan.com/posts/using-the-egm-4/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Using the EGM-4 \u0026 open-egm4 software",
  "name": "Using the EGM-4 \u0026 open-egm4 software",
  "description": " Backup your data regularly. The EGM-4\u0026rsquo;s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten. You are responsible for your data. Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally. Don\u0026rsquo;t get water in the gas lines. If you do, it might enter the IRGA itself and damage it. It\u0026rsquo;s like $15,000 to replace. Introduction The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.\n",
  "keywords": [
    
  ],
  "articleBody": " Backup your data regularly. The EGM-4’s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten. You are responsible for your data. Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally. Don’t get water in the gas lines. If you do, it might enter the IRGA itself and damage it. It’s like $15,000 to replace. Introduction The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.\nThe open-egm4 software is a terminal interface designed to make data collection from the EGM reliable and easy. Unlike the legacy (read: outdated, buggy and frustrating) Windows software from PP Systems, this runs on macOS, Linux, and modern Windows systems.\nThis guide covers operation of the EGM itself, the SRC-1 chamber, how to use them alongside the open-egm4 software, common field scenarios and troubleshooting everything involved.\nInstalling open-egm4 What is open-egm4?\nA terminal-based (text interface) application that communicates with the EGM Provides real-time CO₂ visualization, data logging, and exporting of said data to a csv Works on any modern operating system Can run over SSH for remote field work (if anyone thinks of a genuine use case for this please tell me) What is a Terminal? A terminal (also called “command line” or “shell”) is a text-based interface for your computer. Think of it as typing commands directly to your computer instead of clicking on icons. Using a computer through the terminal (or, pedantically, it’s terminal) typically gives you much greater control and choice over its operation. In this case, open-egm4 was developed as a TUI (terminal user interface: an app that runs inside of the terminal) because it allows the app to be significantly smaller, more portable, and more lightweight to run on underpowered computers.\nFor more information on my debatable decision to develop the app for the terminal, see the appendix.\nSystem Requirements:\nmacOS 10.14+, Windows 10+, or any modern Linux Python 3.8+ (the installer handles this automatically) USB serial port or USB-to-serial adapter Note If you are buying a USB-serial adapter, make sure to get one that uses a FTDI chipset. Cheap adapters often use “Prolific” chips which have notoriously bad drivers. FTDI chips are easier and require zero thought to use. Internet connection (for installation only) One-Line Installation This is the easiest method. A script handles everything: installing Python dependencies, downloading the software, and setting up shortcuts so you can run open-egm4 from anywhere.\nStep 1: Open Your Terminal macOS:\nPress Cmd + Space to open Spotlight search. Type “Terminal” Press Enter A window with white or black background appears—this is your terminal. Windows:\nClick the Start Menu (Windows logo) Type “PowerShell” Press Enter A window appears with text—this is your terminal (command prompt is also a terminal, but it is exclusive to Windows; it has also been around since the 80s: PowerShell is Microsoft’s attempt at an updated terminal for Windows.) Linux: You already know how to open a terminal.\nStep 2: Copy and Paste the Installation Command With great power… Entering commands into a terminal gives you much more control over your computer than most users are used to. While this power is beneficial for knowledgeable users, it also makes it easy to make potentially irreversible mistakes. …comes great responsibility. You should never copy and paste commands into your terminal from sources you do not trust. A malicious command could delete files, install malware, or send your data to an attacker. While I wrote this script, you are ultimately trusting me not to do something harmful. You can (and really should) view the install script source before running it. In your terminal window, copy and paste this line as written:\nmacOS / Linux:\ncurl -sSL https://raw.githubusercontent.com/mmorgans/open-egm4/main/install.sh | bash Windows (PowerShell):\nirm https://raw.githubusercontent.com/mmorgans/open-egm4/main/install.ps1 | iex How to Paste in Terminal:\nmacOS: Press Cmd + V (normal paste works) Windows (PowerShell): Right-click to paste, OR Ctrl + Shift + V Linux: Ctrl + Shift + V (not Ctrl + V!) Press Enter to run the command.\nRunning the installation script when open-egm4 is already installed allows you to update, repair, or uninstall the software. Step 3: What You’ll See During Installation After pressing Enter, text will start scrolling down the screen. You’ll see messages like:\n[INFO] Checking prerequisites... [INFO] Installing fresh to /Users/hello/.open-egm4... [INFO] Creating virtual environment... [INFO] Fetching latest version and installing dependencies... The installation takes 1-3 minutes depending on your internet speed. When you see “Installation Complete”, it’s done.\nTroubleshooting:\nOn Linux, you might need to add your user to the dialout group to access the serial port. You can do this with the command sudo usermod -a -G dialout $USER If you see “curl: command not found” on Windows, try using PowerShell instead of cmd If you see “Python not found”, the installer will attempt to install it automatically If installation fails, try the manual installation below. If it still doesn’t work, shoot me an email and I’ll try to help. Pip Installation If you’re comfortable with Python environments:\n# Install via pipx (recommended for isolation) pipx install git+https://github.com/mmorgans/open-egm4 # OR install in your active virtual environment pip install git+https://github.com/mmorgans/open-egm4 If you want to edit the code of open-egm4, there are more instructions on the repository page.\nInitial Connection to the EGM-4 Once software is installed, connect the EGM to a computer:\nPhysical Connection: Connect the serial cable to the EGM’s RS232 port Connect the USB-to-serial adapter to your computer Power on the EGM with the switch on the back When the EGM-4 boots, pay attention to the startup screen values. For example:\nC 2000 5V=2000\nProbetype 8 R248\nThis is useful because it tells you how that specific instrument is calibrated. In this example, C 2000 indicates the analyzer is calibrated to a 2000 ppm range.\nLaunch the Software: On your computer, in the terminal, run\nopen-egm4 Select Serial Port: The software will list available serial ports (e.g., /dev/tty.usbserial, COM3) It will also attempt to guess at which one the EGM is connected to and automatically connect to it If it doesn’t, select the port manually using the arrow keys, and hit Enter to confirm your choice. If you don’t see your port listed, check the cable connection and hit r on your keyboard to refresh the list of ports. On macOS, look for ports containing “usbserial” or “FTDI” On Windows, look for “COM” ports (COM3, COM4, etc.) Windows lacks default braille support, so open-egm4 automatically uses lower-detail symbols if running on Windows. If you install a compatible font, launch open-egm4 with the --force-unicode flag to enable high-detail braille graphs. You can see which platform and graphics mode open-egm4 is using on the splash screen. Verify Connection:\nThe EGM screams out data over the serial connection, but it’s incapable of receiving any data back. Therefore, you’ll have no way of knowing if you’re actually connected to the EGM unless you dump some data to your computer. Details on how to collect data are in the workflow section, but for now you can verify that the software was installed correctly by dumping existing data from the EGM to your computer, assuming that there is pre-existing data on the EGM. To send data from the EGM to a computer, press 4DMP on the EGM, then 2 DATA DUMP, then press any key to begin the transfer. If you see the data streaming in on your computer, celebrate. If you don’t, then check out the troubleshooting section. Press q to quit (or Ctl + c, which should quit most running terminal commands) when you’re done exploring.\nEGM-4 hardware Physical Interface \u0026 Controls The EGM-4 is a portable, battery-powered CO₂ analyzer. Key components:\nFront Panel:\nLCD Display: 2×16 character display 1-9 keypad, along with Y/R key (used for accepting and recording) and N key (used for denying and going back) 8/X allows you to toggle between display screens while taking a measurement 0/Z allows you to manually zero the EGM-4 during a measurement Top:\nGas In Port: Connect sample inlet tubing (1/8\" ID) Gas Out Port: Exhaust port (1/8\" ID) AND (counter-intuitively) should be used as an injection port for static syringe samples I/O Connectors: Two 15-pin D-sub connectors for sensors (notably the SRC-1) RS232 Port: 9-pin connector for data transfer to a computer Back:\nPower Switch: Self explanatory 12V DC Charge Socket: For charging the internal battery and running the EGM off of mains power Fuse: 1A fuse Soda Lime Cap: Access to the CO₂ scrubbing column for replacing it. Power \u0026 Battery The EGM-4 uses a 12V 2.0Ah sealed lead-acid battery. It should last around 4 hours of use at 20ºC. If the temperature is below 5ºC, the battery life drops 30-40%.\nAt low temperatures, you should hold the EGM inside your jacket, maintaining skin-to-skin contact. This will increase the battery life by a few minutes, and will psychologically bond you with the device. Charging: The manual purports that the battery takes 12 hours to charge fully. I think that’s a made up number, and in my testing it’s ready for action after around 2 hours. Your mileage may vary.\nIf you are planning on storing the EGM long term, charge the battery beforehand to avoid damaging it.\nThe EGM’s internal clock loses time when the battery dies. After replacing or fully recharging the battery, make sure the date/time settings are correct before taking measurements. This is critical for ensuring that your data is properly timestamped. Replacement: To replace the battery, see the troubleshooting section.\nSRC-1 Soil Respiration Chamber The SRC-1 is a soil respiration chamber that allows you to measure the rate of soil respiration by monitoring the rate of increase of CO₂ concentration within a closed system: the chamber itself. See the SRC-1 Workflow section.\nopen-egm4 software This section covers how to use the open-egm4 software, assuming you’ve already installed it.\nLaunch the software by running open-egm4 in your terminal.\nConnection screen When you launch the software, you’ll see the connection screen, with a list of ports.\nOpen-egm4 will attempt to detect which port the EGM-4 is connected to and automatically connect to it after 5 seconds. Use the arrow keys to cancel this countdown and select a port manually.\nTo select a port manually, use the arrow keys to navigate the list of ports and press Enter to confirm your selection. If you don’t see your port listed, check the cable connection and hit r on your keyboard to refresh the list of ports. If you accidentally select the wrong port, hit q to quit and try again.\nOn macOS and Linux, the EGM-4 will likely appear as a port containing “usbserial” or “FTDI” On Windows, the EGM-4 will likely appear as a “COM” port (COM3, COM4, etc.) Open-egm4 automatically saves data to its internal database. This allows you to restore from a previous session without having to re-dump data from the EGM. To do this, press s while on the connection screen. You’ll see a list of saved sessions, and you can use the arrow keys to select one and press Enter to restore it. You do not need to have the EGM connected to the computer to restore a session. While the EGM is not connected, “Offline” will be displayed in the status panel.\nMain interface This is the main interface, where you’ll spend most of your time. It consists of:\nLeft Panel - Graph: This panel displays incoming data from the EGM, whether it be from a live measurement or previously generated data. The axes will automatically rescale to fit the data. The units will also change depending on how you are viewing the data, so be sure to check the legend to understand what you’re looking at.\nDirectly below the graph are the available channels and graph controls. The available channels will change depending on what probe was connected when the the data was recorded. Press the number key associated with each channel to view that channel in the graph.\nAbove the graph, you’ll see information about what the graph is currently displaying, including the currently selected channel, the units of the y-axis, and the plot number.\nPress the \u003c or \u003e keys to cycle through different plots. This is useful to view measurements from a specific location (i.e. a plot in the field), and to filter out data you aren’t interested in viewing.\nPress i to toggle inspect mode on the graph. In this mode, a yellow x appears on the graph, and you can use the left and right arrow keys to move the cursor along the x-axis. The y-values for the currently selected channel at the cursor’s position are displayed above the graph. Press i again to exit inspect mode.\nRight Panels - Status and Log: These panels display the current status of the EGM and the log of recent events. The status panel shows the current CO₂ concentration, along with derived statistics from that value. The log panel shows EGM system messages and app events.\nFooter: The footer displays a list of all commands, along with their keyboard shortcuts.\nKeyboard Commands Key Action Description q Quit Saves and exits as quickly as possible e Export Opens the export screen to save data as CSV c Clear Clears all chart data (with confirmation) p Pause Pauses/resumes the data stream n Note Add a timestamped note to the log b Big Mode Large CO₂ display for visibility outdoors d Theme Toggle between dark and light themes i Inspect Toggleable mode to examine individual points ? Help Information about the app 1 - 9 Switch between data channels , / . Cycle between different plots \u003c / \u003e Same as above: plot selection ← / → Move cursor (when in Inspect mode) Exporting data Press e to open the export screen. This allows you to filter and export your data.\nAt the top of the export screen, you’ll see the number of data currently selected to export. Initially, this will be all of the data currently in the app.\nFiltering data To export only a subset of that data, use the p and d keys to select only certain plots and dates, respectively.\nTo select specific plots to export, press p to open the plot selection screen. Use the arrow keys to navigate the list of plots and press Space to select or deselect a plot. Press p again to confirm and return to the export screen.\nTo select specific dates to export, press d to open the date selection screen. Use the arrow keys to navigate the list of dates and press Space to select or deselect a date. Press d again to confirm and return to the export screen.\nYou should see the number of data points to export update as you make your selections. Once you’ve selected the data you want to export, press e to export the data.\nOutput .csv files should be saved to your Downloads directory. If this fails, the file will be saved in the same directory as open-egm4 was run in (likely your home directory).\nPausing (p) Press p to pause the data stream. While paused, the chart will stop updating with data, but you can still interact with the app. This is useful if you need to examine the chart without it updating with new data. Press p again to resume the data stream.\nAdding notes (n) Press n to add a timestamped note to the log. This will open a prompt where you can type a note. Press Enter to save the note, or Esc to cancel.\nStatic sampling mode (m, n, x) Static sampling mode guides syringe-injection sampling directly from the monitor screen.\nPress m to toggle static sampling mode on or off. When enabled, the stats panel shows STATIC SAMPLING and the current step prompt. Press n to advance the guided cycle: STEP 1: INJECT SAMPLE (N) STEP 2: WAIT TO SETTLE, CAPTURE (N) STEP 3: INJECT AMBIENT AIR (N) During Step 2, pressing n opens a label prompt for the sample. You can leave it blank to auto-name the sample. open-egm4 records both the settled concentration and the post-injection peak concentration for each captured sample. Press x at any time to reset the cycle back to Step 1. Exported CSV files include static sample rows (type=SAMPLE) with sample_id, sample_label, sample_ppm, and sample_peak_ppm. Clearing data (c) Press c to clear all data from the current session. You will be asked to confirm before the data is cleared.\nThis does not clear data from the EGM’s internal memory, only data that you have already dumped to the app. To clear data from the EGM’s internal memory, see the initialize section. Quitting (q) Press q to quit the app. All data from your session are automatically saved (distinct from .csv files you may have exported), and you can restore it the next time you open the app by pressing s while on the connection screen.\nOpen-egm4 automatically saves data to an internal database. To restore from a previous session, see the connection screen section. Workflows Workflow 1: Soil Respiration with SRC-1 Chamber This is the most common application: measuring CO₂ efflux from soil using the SRC-1 closed-chamber method.\nEquipment Needed:\nEGM-4 with fully charged battery SRC-1 soil respiration chamber Soil collars* Optional: Laptop running open-egm4 for monitoring Soil Collars: Install the soil collars well before you plan to measure (this should be planned prior to doing field work). A well-placed collar should be installed 3-5cm deep into the soil surface. Remove any aboveground vegetation inside the collar.\nThe above instructions depend almost entirely on your situation. You might consider installing the soil collar weeks or months ahead of time. The depth of the collar needed to ensure a good measurement will depend on the soil type and the goals of your experiment. Field Procedure:\nConnect SRC-1 to EGM-4:\nConnect the I/O cable of the SRC-1 to the EGM-4 Connect the gas tube labeled “R” to the gas in port of the EGM-4 Connect the unlabeled gas tube to the gas out port of the EGM-4 Startup \u0026 Warmup (10-15 minutes):\nPower on the EGM Wait for warm-up message to complete: the EGM must reach an internal temperature of 55°C to be able to take readings Enter Measurement Mode:\nPress 1 (REC) from the main menu The EGM will display measurement settings Default: DT=120 seconds (measurement duration), DC=50 ppm (max CO₂ change) Press N to change settings, or Y to confirm and continue Select Fitting Method:\nAfter confirming settings, the EGM will display 1LINEAR 2QUAD? Press 1 for Linear Fit: Best for short measurements (under 2 minutes) or low-flux soils Press 2 for Quadratic Fit: Better for longer measurements or high-flux soils where CO₂ buildup may cause the flux rate to level off Linear fitting assumes a constant flux rate throughout the measurement. Quadratic fitting accounts for the natural slowdown that occurs as CO₂ builds up in the chamber. If you’re unsure, quadratic is generally safer for measurements over 2 minutes. See Appendix B for the math behind each method. You should think carefully about the DT value that you set for a given measurement, especially if you selected a linear fit. If the DT value is too large the rate at which CO₂ accumulates in the chamber will decline, and your estimate of the efflux rate will be less accurate. Set Plot Number: The EGM will display “PLOT NO = X” Press Y to keep the current plot number Or enter a new plot number (e.g., “01” for plot 1) and press Y If you use a plot number that has already been used, the EGM will overwrite the previous measurement, causing irreversible data loss. Chamber Flush:\nThis happens automatically. The EGM will display “CHAMBER FLUSHING - HOLD IN AIR” Hold the chamber in the air for ~15 seconds at arms length Deployment:\nThe EGM will display “PLACE ON SOIL - PRESS Y TO START” Place the chamber on the soil collar, using Blu Tack on the rim of the chamber to ensure a good seal Press Y to start measurement Equilibration:\nThe EGM will display “EQUILIBRATION - PLEASE WAIT” The system will equilibrate for ~5 seconds Then measurement begins automatically Measurement:\nThe EGM will display: C 420 H14.7 T22 A02.11 Q0000 110 C: Current CO₂ (ppm) H: Humidity (mb, if sensor connected) T: Soil temperature (°C, if sensor connected) A: Calculated flux rate (g CO₂ m⁻² hr⁻¹) Q: PAR light level (if sensor connected) 110: Elapsed time (seconds) — shows “END” when complete After a measurement, you will be prompted to save the measurement with “RECORD Y/N” Press Y to save the measurement Press N to discard and retry Remove Chamber \u0026 Continue:\nThe EGM will display “REMOVE FROM SOIL THEN PRESS Y KEY” Lift chamber from soil collar Press Y to prepare for the next measurement The plot number will not auto-increment. You must manually enter the plot number for each measurement. Note that the EGM will happily overwrite the previous measurement if you don’t change the plot number between measurements! Data Viewing \u0026 Storage: Though not necessary, you can have your computer connected to the EGM while you are taking soil repisration measurements. This allows you to view the incoming the data in real time, using open-egm4, and see it graphed. This can be helpful for understanding how long it takes your soil system to produce enough CO₂ to lessen the diffusion gradient driving respiration fluxes into the chamber.\nRegardless, because you designated a plot number before you started the measurement, the EGM will store the data in its internal memory. The EGM stores up to 1,500 records, and will start overwriting old records if full. See instructions on how to export data from the EGM.\nTo transfer stored records from field plots on the EGM-4 to your computer, do the following:\nConnect the EGM-4 to your computer using a serial cable and USB adapter Power on the EGM-4 and open the open-egm4 app on your computer by typing open-egm4 in the terminal Press 4DMP from the Main Menu on the EGM-4, then Press 2 DATA DUMP Once the open-egm4 app is ready, press any key on the EGM-4 to start the transfer View your data on the graph, and use the \u003c and \u003e keys to view a specific plot Press e to open the export menu. Use the p and d keys to select the plot(s) and/or date(s) you want to export, then press e to export The .csv will be saved to your Downloads directory Data Record Structure:\nEach record contains (in CSV format):\nM/R flag (M=real-time, R=stored record) Plot number (0-9999) Record number (1-9999) Date (day, month) Time (hour, minute) CO₂ (ppm) H₂O vapor (mb, if sensor present) RH/Temp sensor data Sensor inputs A-E (mV values) Atmospheric pressure (mb) Probe type (0-11) Workflow 2: Static Sampling via Syringe Injection Static sampling is used when you want to measure CO₂ concentration of a discrete air sample without continuous flow. Common applications: measuring gas concentrations from sealed containers, soil headspace, or captured gas samples.\nInstead of pumping air continuously through the EGM-4, you inject a small volume of sample directly into the measurement cell using a syringe. The internal pump is turned off to avoid diluting your sample.\nEquipment Needed:\nEGM-4 with battery Luer-lock syringe (5-10 ml) Sample vial or other vessel from which you will take a syringe sample A female luer-lock adapter to connect the syringe to the EGM A computer with open-egm4 installed Ensure that water does not enter the EGM when injecting a sample. If water enters the EGM, it will damage the IRGA. Setup Procedure:\nConnect to Computer:\nConnect the EGM to your computer using a serial cable and USB adapter Open the open-egm4 app on your computer by typing open-egm4 in the terminal Enable Static Sampling Mode on the EGM:\nFrom Main Menu, press 2 (SET) Press 3 (PMP) to access pump control Current display shows “SAMPLE PUMP ON / Y/OK N/CHANGE” Press N to change Display now shows “STATIC SAMPLING / Y/OK N/CHANGE” Press Y to confirm Prepare for Injection on the EGM:\nPress 1 (REC) to enter measurement mode The EGM will show the current CO₂ concentration Observe the baseline CO₂ concentration on your computer over time Enable guided static workflow in open-egm4:\nPress m on the monitor screen to enable Static Sampling mode The stats panel should show STATIC SAMPLING and STEP 1: INJECT SAMPLE (N) Press x at any time to reset the cycle back to Step 1 Inject sample and acknowledge Step 1:\nDraw sample into syringe (at least 5 ml is recommended for a stable reading) Locate the gas out port on top of EGM and ensure that the female luer-lock adapter is securely connected Attach the luer-lock syringe to the gas out port and inject sample Press n immediately after injection to acknowledge Step 1 and start peak tracking Capture settled value (Step 2):\nWatch the concentration spike and then settle Press n when the value has stabilized to capture the sample Enter an optional sample label when prompted (leave blank for auto labels like “Sample 1”) open-egm4 saves both: the settled concentration (sample_ppm) the highest concentration seen after injection (sample_peak_ppm) Flush and reset (Step 3):\nInject ambient air into the EGM to flush the cell between samples Press n to confirm flush and automatically return to Step 1 for the next sample Data downloading and sample metadata:\nStatic sample events are stored only in the open-egm4 session on your computer Export with e (open export screen), then e again to write CSV CSV exports now include type=SAMPLE rows with: sample_id sample_label sample_ppm (settled value) sample_peak_ppm (post-injection peak) The CSV will still include normal second-by-second measurement rows for the full session Auto-Zero Warnings in Static Mode: The EGM-4 will still perform automatic zeros even with pump off. You’ll see warnings:\n“AUTO ZERO IN 2 MINUTES” “AUTO ZERO IN 1 MINUTE” When zero begins, the pump turns on for ~15 seconds, then turns off again. This ensures an accurate baseline by passing air scrubbed of CO₂ by the soda lime to the IRGA, and setting its CO₂ concentration to 0 ppm.\nDon’t forget to re-enable the pump after you have run all of your samples. Troubleshooting \u0026 Maintenance Only open the unit if you feel comfortable with electronics. Static discharge can damage sensitive components. Ground yourself before poking around. Replacing the Soda Lime CO₂ Scrubber The EGM needs to know what zero CO₂ looks like to make accurate measurements, and uses the soda lime to figure that out. Gradually, the granules in the soda lime column become saturated with CO₂ and can no longer absorb it, becoming pale in color as they do so. Replace when around 2/3 of the column have changed color.\nTo do this, unscrew the black cap on the back panel, pour out the old granules, and fill the column with fresh soda lime, leaving about an inch of space at the top. Replace the foam filter and cap.\nWash your hands after handling soda lime. It’s caustic. Replacing the Internal Battery The internal battery will need to be replaced after a few years of use. If you are unable to get more than 2 hours out of a single charge, the internal battery needs to be replaced.\nRemove the fuse On the back cover, slightly twist to remove the 1A fuse, and set it aside Remove the main cover Flip the EGM on it’s back Remove the 4 screws with a #1 Phillips screwdriver Carefully lift the EGM out of the cover by lifting the front and rear top edges Remove the back cover On the back cover, remove the two screws on the left and right edge with a #1 Phillips screwdriver Carefully lift the back cover away from the EGM by lowering the top of the cover, and leaning it away from the EGM You’ll need to tilt the rear cover until it’s perpendicular to the EGM to remove it Remove the front cover Using a 5.0mm socket, remove the two nuts on the left and right edges of the front cover Carefully lean the front cover away from the EGM, being sure to not stress the ribbons connecting it to the motherboard The only reason to remove the front cover is to assist in removing the old internal battery, by pushing on it through the hole in the battery enclosure Remove the internal battery Disconnect the battery from the two leads by lightly pulling them away from the battery Push on the battery from the hole in the enclosure, through the front panel, and out of the case Install the new battery Push the new battery into the enclosure, ensuring its seated properly Connect the battery to the two leads by lightly pushing onto the contacts Reassemble the front cover Carefully lean the front cover back into place, being sure to not stress the ribbons connecting it to the motherboard Using a 5.0mm socket, replace the two nuts on the left and right edges of the front cover Reassemble the back cover Carefully slide the back cover back into place, being sure to not stress the ribbons connecting it to the motherboard On the back cover, replace the two screws on the left and right edge with a #1 Phillips screwdriver Reassemble the main cover Holding the EGM in the air upside down, position the main cover underneath it, and carefully lower it into place Replace the 4 screws with a #1 Phillips screwdriver Reassemble the fuse On the back cover, slightly push and twist to replace the 1A fuse Replacing internal tubing Over time, the internal gas tubing will become aged and leak. You’ll need to replace it with 1/8\" tubing, being careful not to create kinks or bends in the tubing. If you need 90 degree bends, some are available at McMaster-Carr (item number 5463K42).\nEGM-4 error codes The EGM-4 displays numbered error codes when problems occur:\nError 01: Zero Too Low\nCause: Soda lime exhausted, absorber column not seated, or valve failure Solution: Replace the soda lime. Ensure the soda lime cap is tight. Error 02: CO₂ \u003c 250 ppm\nCause: Either genuine low CO₂ or same as Error 01 Solution: If you’re measuring ambient air (\u003e420 ppm), this indicates same problems as Error 01 Error 03: Analyzer Temperature \u003c 50°C\nCause: Instrument too cold or thermostat failure Solution: Allow longer warm-up time, or move somewhere warmer. Error 04: Analyzer Temperature \u003e 60°C\nCause: Instrument overheating or thermostat failure Solution: Turn off, allow to cool. Check for ventilation blockage. Error 05: RH \u003e 90%\nCause: High humidity or water in sample line Solution: In humid conditions, this may be normal. Error 06: Battery Voltage Low\nCause: Battery voltage \u003c 10.5V Solution: Recharge the battery. If problem persists, replace the battery. Software Connection Issues “command not found”: Installation didn’t complete. Try re-installing. “No module named ‘serial’”: Missing dependency—reinstall with pip install pyserial Can’t connect to EGM-4:\nCheck the cables and make sure they’re securely connected Check EGM-4 is powered on Verify you selected the correct serial port Try a different serial port if multiple are available On Linux: check permissions (ls -l /dev/ttyUSB0 should show you have read access) Technical Appendix A: Serial Protocol Specification The EGM-4 communicates over RS-232 serial at 9600 baud, 8 data bits, no parity, 1 stop bit, and no flow control. This is a standard configuration supported by virtually all serial terminal software.\nEach data record is exactly 61 characters long (1 letter followed by 60 digits), with no spaces or delimiters, terminated by a carriage return and line feed (\\r\\n). The manual refers to “60 digits” which excludes the initial M/R mode character. During live measurements, the EGM transmits one record per second. When dumping stored data, all records are sent consecutively.\nHere’s an example raw record:\nR000002180313170042900000000000000000000000000400000000096508\nThe table below shows how to interpret parsed records. Both real-time measurements (M) and stored records (R) use the same format:\nM/R Plot No. Rec No Day Mo Hr Min CO₂ Ref H₂O Ref RHT A B C D E F G H AP PT M 1 1 28 1 13 19 968 0 000.0 0000 0000 0000 0000 0000 0000 00 00 991 0 R 1 2 28 1 13 21 930 0 000.0 0000 0000 0000 0000 0000 0000 00 00 991 0 The fixed columns are:\nColumn Description M/R M = real-time measurement, R = record retrieved from memory Plot No Plot number, 0-99 Rec No Record number within the plot, 1-9999 Day Day of month, 1-31 Mo Month, 1-12 Hr Hour in 24-hour format, 0-23 Min Minute, 0-59 CO₂ Ref CO₂ concentration in ppm (equivalent to µmol mol⁻¹) H₂O Ref Water vapor in millibars (only if optional RH sensor is fitted) RHT Temperature from RH sensor in °C (if sensor is fitted) A-H Probe-specific fields (see probe type table below) AP Atmospheric pressure in millibars PT Probe type code, 0-11 Columns A through H contain probe-specific data whose meaning depends on the connected sensor:\nType Sensor A B C D E F G H 0 No Sensor (stand-alone) mV Pin 1 mV Pin 2 mV Pin 3 mV Pin 4 mV Pin 5 — — — 1 STP-1 Soil Temp PAR %RH Temp — mV Pin 5 — — — 2 HTR-2 %RH/Temp/PAR PAR %RH Temp — — — — — 3 HTR-1 %RH/Temp/LUX PAR %RH Temp — — — — — 7 PMR-4 Porometer PAR %RH In Temp %RH Out Flow GS — — 8 SRC-1 Soil Respiration PAR %RH Temp DC DT SR Rate — +/- SR Rate 10 50Y %RH/Temp — %RH Temp — — — — — 11 CFX-1 / CPY-3 PAR Evap Rate Temp DC Flow SR Rate Flow Mult. +/- SR Rate The units for each data type are:\nOutput Data Units PAR µmol m⁻² s⁻¹ %RH % Evap Rate mmol m⁻² s⁻¹ × 1000 Temperature °C Flow ml min⁻¹ GS mmol (H₂O) m⁻² s⁻¹ (Stomatal Conductance) SR Rate g CO₂ m⁻² hr⁻¹ for SRC-1; µmol m⁻² s⁻¹ for CPY-3 and CFX-1 DC ppm (change in CO₂ concentration) DT seconds (change in time) +/- 00 = respiration (CO₂ increase), 01 = uptake (CO₂ decrease) For CFX-1/CPY-3, column G contains a flow multiplier (1 or 10) that should be applied to get the true flow rate. Here’s a Python function that parses a raw 61-character record:\nArgs: raw (str): The raw serial string (e.g., 'R00000...') Returns: dict: Key-value pairs of parsed sensor data. \"\"\" # Ensure the string is the expected length after stripping newlines clean = raw.strip() if len(clean) != 61: raise ValueError(f\"Invalid record length: {len(clean)} characters\") return { 'mode': clean[0], # M (Real-time measurement) or R (Stored record) 'plot': int(clean[1:3]), # Plot Number 'record_num': int(clean[3:7]), 'timestamp': { 'day': int(clean[7:9]), 'month': int(clean[9:11]), 'hour': int(clean[11:13]), 'minute': int(clean[13:15]), }, 'co2_ppm': int(clean[15:19]), 'h2o_mb': int(clean[19:23]), 'temperature_c': float(clean[23:28]) / 10.0, # Fixed point div by 10 # ... (Sensors A-H mapped as integer counts) ... 'pressure_mb': int(clean[56:59]), 'probe_type': int(clean[59:61]) } \"\"\"\" Beyond data records, the EGM-4 also sends status messages during startup and operation. A boot message takes the form B,EGM4,, and provides the device’s serial number and firmware version. During warmup, you’ll see W,TT messages where TT indicates the current cell temperature. The instrument sends I,NN during initialization and Z,NN during zeroing, where NN is a countdown counter. Diagnostic messages beginning with D, contain internal state information documented in the manual on page 38.\nB: Flux Calculation Methods The EGM-4 calculates soil respiration flux by monitoring the rate of CO₂ accumulation inside the closed SRC-1 chamber. The fundamental equation derived from the Ideal Gas Law is:\n\\[F = \\frac{dC}{dt} \\times \\frac{V}{A} \\times \\frac{P}{R \\times T}\\]\nWhere:\n\\(F\\) is the CO₂ flux in g CO₂ m⁻² hr⁻¹. \\(\\frac{dC}{dt}\\) is the rate of change in CO₂ concentration (ppm s⁻¹). \\(V\\) is the total system volume (chamber + tubing). \\(A\\) is the soil surface area enclosed by the chamber. \\(\\frac{P}{RT}\\) converts the concetration change to molar units. Linear vs. Quadratic When you start a measurement using the SRC-1, you’ll be prompted to select the fitting method: 1LINEAR 2QUAD?. This selection determines how the EGM calculates the slope (\\(\\frac{dC}{dt}\\)) from the raw concentration data.\n1. Linear Fit (1): This method assumes that the accumulation is a straight line (\\(C = C_0 + kt\\)). You should choose it for short measurement periods, typically under 2 minutes, or low-flux soils.\n2. Quadratic Fit (2): As CO₂ accumulates in the chamber, the concentration gradient decreases, causing the flux rate to slow down or level off. This method accounts for this by fitting a curve to the data (\\(C = C_0 + kt + ct^2\\)).\nIf you select Quadratic fit and the curvature is excessive (specifically, if the quadratic term \\(ct\\) exceeds 20% of the linear term \\(b\\)), the EGM will yell NON LINEAR FIT. This indicates a significant leak or chamber saturation. Chamber Corrections For the SRC-1, the default chamber volume is 1171 ml with a soil contact area of 78.5 cm² (corresponding to the 10 cm diameter opening). Tubing typically adds 50–100 ml to the total volume. If you’re using a custom chamber setup, calculate the total volume as the chamber volume plus the tubing volume, where tubing volume can be calculated as \\(V_{tubing} = \\pi r^2 L\\) with \\(r\\) being the internal radius and \\(L\\) the total length in centimeters.\nTemperature should really be measured inside the chamber using the RH/Temp sensor or an STP-1 probe, because the sample air temperature directly affects the flux calculation.\nThe EGM-4 measures atmospheric pressure internally and applies corrections automatically. At higher elevations, pressure drops significantly: approximately 900 mb at 1000 m and 800 mb at 2000 m compared to 1013 mb at sea level. This affects how many CO₂ molecules occupy a given volume.\nWorked Example Flux is measured by placing a closed chamber on the soil and monitoring the rate of CO₂ concentration increase inside the chamber. Assuming a well-mixed, sealed system:\n\\[R = \\frac{(C_n - C_0)}{T_n} \\times \\frac{V}{A}\\]\nwhere \\(R\\) is the flux (CO₂ per unit area per unit time), \\(C_0\\) is the initial CO₂ concentration, \\(C_n\\) is the concentration after time \\(T_n\\), \\(V\\) is the total system volume, and \\(A\\) is the exposed soil area.\nOver short measurement periods with small concentration changes relative to soil CO₂ levels, flux should be constant, giving a linear concentration increase. However, any chamber leakage causes the apparent flux to decrease with time, producing a curved response. Fitting a quadratic equation \\(C = a + bT + cT^2\\) between concentration and time allows extraction of the true initial flux rate.\nSince \\(\\frac{dC}{dT} = b + 2cT\\), at time \\(T = 0\\) we have \\(\\frac{dC}{dT} = b\\). This gives the instantaneous flux rate before leakage effects accumulate and become a problem. Comparing the magnitude of \\(cT\\) to \\(b\\) indicates leakage severity—the EGM will yell NON LINEAR FIT at you if \\(cT\\) exceeds 20% of \\(b\\).\nFrom the basic equation, \\(R = b \\times \\frac{V}{A}\\). To express flux in mass per unit area per unit time, the rate \\(b\\) must be in mass per unit volume. The CO₂ analyzer measures volume/volume ratio (ppm by volume = µL/L = µbar/bar = µmol/mol).\nOne kilogram-mole of gas (44.01 kg of CO₂) occupies 22.41 m³ at STP. The full conversion equation is:\n\\[R = b \\times \\frac{P}{1000} \\times \\frac{273}{273 + T_a} \\times \\frac{44.01}{22.41} \\times \\frac{V}{A}\\]\nwhere \\(R\\) is flux in kg m⁻² s⁻¹, \\(b\\) is measured as ppm s⁻¹, \\(P\\) is atmospheric pressure in mb, \\(T_a\\) is air temperature in °C, \\(V\\) is system volume in m³, and \\(A\\) is exposed area in m².\nIn practice, the EGM measures \\(\\frac{dC}{dt}\\) in ppm/second, \\(V\\) in cm³, and \\(A\\) in cm². Results are expressed as g m⁻² hr⁻¹. To convert g m⁻² hr⁻¹ to µmol m⁻² s⁻¹, multiply by 6.312.\nEnvironmental correction notes:\nWater Vapor: Adding water vapor to dry air dilutes the CO₂ concentration because the total air volume increases. From an infrared measurement perspective, water vapor induces a slight increase in CO₂ absorption (foreign gas broadening) that approximately cancels the dilution effect. The net result is that the analyzer reports approximately the dry-gas concentration.\nAtmospheric Pressure: Increased pressure raises concentration according to the Gas Law, but infrared absorption increases more than expected due to pressure broadening of absorption bands. The approximate correction is:\n\\[C = C_M \\times \\frac{1000}{0.75P + 0.00025P^2}\\]\nwhere \\(C\\) is the concentration that would be measured at 1000 mb and \\(C_M\\) is the concentration measured at \\(P\\) mb.\nAir Temperature: With the EGM’s thermostatted detector at 45°C, the primary temperature effect is on gas density, following the Gas Law (approximately −0.3% per °C increase). The correction referenced to calibration at 0°C is:\n\\[C = C_M \\times \\frac{273 + T_a}{273}\\]\nWhen all corrections are applied, the complete equation becomes:\n\\[R = b \\times \\frac{1000}{1000} \\times \\frac{1000}{P(0.75 + 0.00025P)} \\times \\frac{273 + T_a}{273} \\times \\frac{273}{273 + T_a} \\times \\frac{44.01}{22.41} \\times \\frac{V}{A}\\]\nSimplifying:\n\\[R = \\frac{b \\times 44.01 \\times V}{(0.75 + 0.00025P) \\times 22.41 \\times A}\\]\nThe temperature corrections cancel, and the pressure effect is small. When calibrating at high altitude, the simplified form uses average atmospheric pressure at that altitude:\n\\[R = b \\times \\frac{P_{av}}{1000} \\times \\frac{44.01}{22.41} \\times \\frac{V}{A}\\]\nMeasurement accuracy can be compromised by chamber leaks (which typically cause underestimation), temperature gradients inside the chamber (like being exposed to direct sunlight), pressure fluctuations from wind or weather changes, and non-representative soil coverage due gaps in the collar seal. Make sure your Blue Tack is firmly pressed into place and isn’t leaving any holes. C: Probe Types Reference (0-11) The EGM-4 automatically identifies connected sensors by reading a code resistor on Pin 1 of the 15-pin connector. When you power on the device with a sensor attached, the startup screen displays “PROBETYPE X” where X is the detected type number from the table below:\nType Sensor/Probe Code Resistor Typical Use 0 No sensor None Stand-alone CO₂ analyzer 1 STP-1 Soil Temperature 100 kΩ Soil temperature logging 2 HTR-2 RH/Temp/PAR 56 kΩ Environmental monitoring 3 HTR-1 RH/Temp/PAR 36 kΩ Environmental monitoring (legacy) 4 PAR-1 Light Sensor 27 kΩ PAR (photosynthetically active radiation) 5 PAR-1 LUX 20 kΩ Light intensity in lux 6 SRM-1 15 kΩ Solarimeter 7 PMR-4 Porometer User-set Leaf stomatal conductance 8 SRC-1 Soil Respiration 9.1 kΩ Closed-system soil CO₂ flux 9 RH/T/O₂ 20 kΩ Humidity, temp, oxygen 10 50Y RH/Temperature 5.6 kΩ Humidity and temperature only 11 CFX-1 / CPY-3 4.3 kΩ Open-system flux chambers For Type 2, 3, and 10 sensors, the raw millivolt readings can be converted to physical units using these relationships: PAR equals the millivolt reading multiplied by 3 (giving µmol m⁻² s⁻¹), relative humidity equals the millivolt reading divided by 10 (giving percent), and temperature equals the millivolt reading divided by 20 (giving °C).\nIf you’re using non-PP-Systems sensors or need to override auto-detection (for Type 0 or 7), you can manually set the probe type through Menu 2 (SET), then option 1 (EGM), where you select stand-alone mode, probe mode, or porometer mode.\nCustom sensors can be connected to the I/O ports, which accept 0–1V input signals. The readings appear as millivolt values (0–1000 mV) in the A through E fields of data records. When using custom sensors, ensure your output is scaled to the 0–1V range and apply your own conversion factors during post-processing.\nD: Water Vapor \u0026 Temperature Corrections CO₂ measurements are affected by both water vapor and temperature. The EGM-4 applies corrections automatically when appropriate sensors are connected, but understanding these effects helps in troubleshooting anomalous readings.\nWater vapor dilutes the mole fraction of CO₂ in air. The relationship between wet and dry CO₂ concentrations is:\n\\[C_{dry} = \\frac{C_{wet}}{1 - \\frac{e}{P}}\\]\nHere, \\(C_{dry}\\) is the CO₂ concentration in dry air (ppm), \\(C_{wet}\\) is the measured concentration in humid air, \\(e\\) is water vapor pressure in millibars, and \\(P\\) is total atmospheric pressure in millibars.\nAs a practical example: if you measure 400 ppm CO₂ in air with 20 mb of water vapor at 1013 mb total pressure, the correction factor is \\(1 - (20/1013) = 0.980\\), giving a dry-air equivalent of \\(400 / 0.980 = 408\\) ppm. The EGM-4 applies this correction automatically when an RH/Temp sensor is connected; without the sensor, no correction is applied.\nTemperature affects CO₂ measurements in several ways. Colder air has higher gas density (more molecules per unit volume), detector sensitivity varies with temperature, and temperature is a direct input to flux calculations. To minimize temperature effects on the IRGA itself, the EGM-4 thermostatically maintains the sample cell at 55°C.\nFor best results, always use an RH/Temp sensor for accurate measurements, record the temperature inside the chamber (using an STP-1 if available) for flux calculations, and expect 2–4% corrections to CO₂ values when humidity exceeds 90%.\nE: Chamber Volume Calculations Accurate flux measurements depend on knowing the total system volume, which includes both the chamber and all connecting tubing. For the SRC-1, the manufacturer specifies a chamber volume of 1171 ml. Adding the standard tubing (typically 50–100 ml depending on length) gives a total system volume of roughly 1220–1270 ml.\nFor cylindrical chambers, volume is calculated as \\(V = \\pi r^2 h\\), where \\(r\\) is the radius and \\(h\\) is the height, both in centimeters, yielding volume in cubic centimeters (equivalent to milliliters). Tubing volume uses the same formula: \\(V_{tube} = \\pi r^2 L\\), where \\(L\\) is the total tubing length.\nAs an example, 1/8\" inner diameter tubing has an internal diameter of 3.175 mm, or a radius of 0.15875 cm. For 100 cm of this tubing, the volume is \\(\\pi \\times (0.15875)^2 \\times 100 = 7.9\\) ml.\nThe soil contact area is similarly calculated as \\(A = \\pi r^2\\). For the SRC-1 with its 10 cm diameter opening, this gives \\(A = \\pi \\times 5^2 = 78.5\\) cm².\nTo enter custom volume and area values in the EGM-4, press 1 (REC) from the Main Menu, then press N at the settings screen to modify values. Press 1 to change volume or 2 to change area, enter your new values, and the EGM-4 will automatically update the V/A ratio used in flux calculations.\nThe volume-to-area ratio determines how quickly CO₂ accumulates for a given flux rate. A high V/A ratio means slower accumulation and longer measurement times, while a low V/A ratio results in faster accumulation. For soil respiration work, typical V/A ratios are around 15 cm; the SRC-1 default is 14.9 cm.\nF: open-egm4 Software Design Philosophy This section explains why open-egm4 was built as a terminal user interface (TUI) and how the software works internally.\nWhy a Terminal Interface? I deliberately chose to use a text-based interface instead of a graphical interface for several reasons.\nChiefly, keep it simple, stupid. Additionally, it makes cross-platform support automatic, while the previous PP Systems software was Windows-only. It also eliminates dependencies on GUI toolkits, which can be a pain to install and maintain. It allows for remote access via SSH, which could theoretically be useful. I guess. A terminal interface is inherently scriptable and automatable, and it’s much easier to fix if something goes wrong.\nAdvantages Over Legacy Windows Software The official PP Systems software is Windows-only and has several limitations. It requires specific .NET framework versions that may conflict with other software, offers no remote access capability, and is closed-source. It also is no longer maintained.\nOpen-egm4 meets and exceeds all of the featues that the official software has to offer.\nOpen-egm4 addresses all of these concerns. It runs on any operating system, is open source under the MIT license, and is actively developed and maintained. The community can contribute features, and it works seamlessly over SSH for remote field sites.\nArchitecture Overview:\nOpen-egm4 is built in Python using the Textual framework for terminal UI rendering.\nThe core serial communication lives in src/egm_interface.py, which defines the EGM4Serial class. This class manages the connection to the EGM-4 via pyserial, parses the incoming 61-character fixed-width data records using position-based slicing, and dispatches parsed data to registered callbacks. The parser handles all probe types (0-11) and extracts fields like CO₂, temperature, humidity, and calculated flux depending on the connected sensor.\nSession persistence is handled by src/database.py, which uses SQLite to store readings across sessions. This allows users to close the app and resume later without losing data. The database stores each reading with its timestamp, plot number, channel values, and session metadata.\nThe TUI itself is composed of screens and widgets in the src/tui/ directory. The main application entry point is src/tui/app.py, which sets up the Textual app and manages screen transitions. Key screens include the connection screen (screens/connect.py), the main monitor screen (screens/monitor.py), the export wizard (screens/export.py), and big mode (screens/big_mode.py).\nThe monitor screen orchestrates real-time display by wiring the serial handler to the chart widget (widgets/co2_chart.py), which renders data using plotext for ASCII plotting. Statistics are calculated and displayed by widgets/stats.py, and the channel legend is managed by widgets/legend.py.\nExport functionality converts session data to CSV format, allowing users to filter by plot number and date range before saving.\nData Flow:\n+----------+ +------------+ +------------------+ | EGM-4 | --\u003e | EGM4Serial | --\u003e | Parser | +----------+ +------------+ +------------------+ | (Parsed Dict) v +-------------------------+ | Textual Event Loop | +-------------------------+ / \\ v v +------------+ +-----------------+ | Database | | MonitorScreen | +------------+ +-----------------+ | / | \\ v CO2 Stats Legend +------------+ Chart | SQLite DB | +------------+ Created in Doom Emacs 2.0.9, using org-mode 9.7.\nWritten in January 2026.\nCreated by Morgan Salisbury 😊🐇⛵️🏔️❤️\n",
  "wordCount" : "8322",
  "inLanguage": "en",
  "datePublished": "2026-02-01T15:25:00-06:00",
  "dateModified": "2026-02-01T15:25:00-06:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://docs.mor-gan.com/posts/using-the-egm-4/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "morgan docs",
    "logo": {
      "@type": "ImageObject",
      "url": "https://docs.mor-gan.com/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://docs.mor-gan.com/" accesskey="h" title="morgan docs (Alt + H)">morgan docs</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://docs.mor-gan.com/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<div class="post-wrapper">
        <aside class="toc-sidebar" id="toc-sidebar">
            <div class="toc-progress"><div class="toc-marker" data-target="#introduction" data-level="2"
                        data-title="Introduction"></div><div class="toc-marker" data-target="#installing-open-egm4" data-level="2"
                        data-title="Installing open-egm4"></div><div class="toc-marker" data-target="#one-line-installation" data-level="3"
                        data-title="One-Line Installation"></div><div class="toc-marker" data-target="#step-1-open-your-terminal" data-level="4"
                        data-title="Step 1: Open Your Terminal"></div><div class="toc-marker" data-target="#step-2-copy-and-paste-the-installation-command" data-level="4"
                        data-title="Step 2: Copy and Paste the Installation Command"></div><div class="toc-marker" data-target="#step-3-what-you-ll-see-during-installation" data-level="4"
                        data-title="Step 3: What You&rsquo;ll See During Installation"></div><div class="toc-marker" data-target="#pip-installation" data-level="3"
                        data-title="Pip Installation"></div><div class="toc-marker" data-target="#initial-connection-to-the-egm-4" data-level="3"
                        data-title="Initial Connection to the EGM-4"></div><div class="toc-marker" data-target="#egm-4-hardware" data-level="2"
                        data-title="EGM-4 hardware"></div><div class="toc-marker" data-target="#physical-interface-and-controls" data-level="3"
                        data-title="Physical Interface &amp; Controls"></div><div class="toc-marker" data-target="#power-and-battery" data-level="3"
                        data-title="Power &amp; Battery"></div><div class="toc-marker" data-target="#src-1-soil-respiration-chamber" data-level="3"
                        data-title="SRC-1 Soil Respiration Chamber"></div><div class="toc-marker" data-target="#open-egm4-software" data-level="2"
                        data-title="open-egm4 software"></div><div class="toc-marker" data-target="#connection-screen" data-level="3"
                        data-title="Connection screen"></div><div class="toc-marker" data-target="#main-interface" data-level="3"
                        data-title="Main interface"></div><div class="toc-marker" data-target="#keyboard-commands" data-level="4"
                        data-title="Keyboard Commands"></div><div class="toc-marker" data-target="#exporting-data" data-level="4"
                        data-title="Exporting data"></div><div class="toc-marker" data-target="#pausing--p" data-level="4"
                        data-title="Pausing (p)"></div><div class="toc-marker" data-target="#adding-notes--n" data-level="4"
                        data-title="Adding notes (n)"></div><div class="toc-marker" data-target="#static-sampling-mode--m-n-x" data-level="4"
                        data-title="Static sampling mode (m, n, x)"></div><div class="toc-marker" data-target="#clearing-data--c" data-level="4"
                        data-title="Clearing data (c)"></div><div class="toc-marker" data-target="#quitting--q" data-level="3"
                        data-title="Quitting (q)"></div><div class="toc-marker" data-target="#workflows" data-level="2"
                        data-title="Workflows"></div><div class="toc-marker" data-target="#workflow-1-soil-respiration-with-src-1-chamber" data-level="3"
                        data-title="Workflow 1: Soil Respiration with SRC-1 Chamber"></div><div class="toc-marker" data-target="#workflow-2-static-sampling-via-syringe-injection" data-level="3"
                        data-title="Workflow 2: Static Sampling via Syringe Injection"></div><div class="toc-marker" data-target="#troubleshooting-and-maintenance" data-level="2"
                        data-title="Troubleshooting &amp; Maintenance"></div><div class="toc-marker" data-target="#replacing-the-soda-lime-co-scrubber" data-level="3"
                        data-title="Replacing the Soda Lime CO₂ Scrubber"></div><div class="toc-marker" data-target="#replacing-the-internal-battery" data-level="3"
                        data-title="Replacing the Internal Battery"></div><div class="toc-marker" data-target="#replacing-internal-tubing" data-level="3"
                        data-title="Replacing internal tubing"></div><div class="toc-marker" data-target="#egm-4-error-codes" data-level="3"
                        data-title="EGM-4 error codes"></div><div class="toc-marker" data-target="#software-connection-issues" data-level="3"
                        data-title="Software Connection Issues"></div><div class="toc-marker" data-target="#technical-appendix" data-level="2"
                        data-title="Technical Appendix"></div><div class="toc-marker" data-target="#a-serial-protocol-specification" data-level="3"
                        data-title="A: Serial Protocol Specification"></div><div class="toc-marker" data-target="#b-flux-calculation-methods" data-level="3"
                        data-title="B: Flux Calculation Methods"></div><div class="toc-marker" data-target="#linear-vs-dot-quadratic" data-level="4"
                        data-title="Linear vs. Quadratic"></div><div class="toc-marker" data-target="#chamber-corrections" data-level="4"
                        data-title="Chamber Corrections"></div><div class="toc-marker" data-target="#worked-example" data-level="4"
                        data-title="Worked Example"></div><div class="toc-marker" data-target="#c-probe-types-reference--0-11" data-level="3"
                        data-title="C: Probe Types Reference (0-11)"></div><div class="toc-marker" data-target="#d-water-vapor-and-temperature-corrections" data-level="3"
                        data-title="D: Water Vapor &amp; Temperature Corrections"></div><div class="toc-marker" data-target="#e-chamber-volume-calculations" data-level="3"
                        data-title="E: Chamber Volume Calculations"></div><div class="toc-marker" data-target="#f-open-egm4-software-design-philosophy" data-level="3"
                        data-title="F: open-egm4 Software Design Philosophy"></div><div class="toc-marker" data-target="#why-a-terminal-interface" data-level="4"
                        data-title="Why a Terminal Interface?"></div><div class="toc-marker" data-target="#advantages-over-legacy-windows-software" data-level="4"
                        data-title="Advantages Over Legacy Windows Software"></div></div>
            <div class="toc-current-label" id="toc-current-label"></div>
            <nav class="toc-nav" id="toc-nav">
                <div class="toc-title">Contents</div><ul>
                    <li>
                        <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                    <li>
                        <a href="#installing-open-egm4" aria-label="Installing open-egm4">Installing open-egm4</a><ul>
                    <li>
                        <a href="#one-line-installation" aria-label="One-Line Installation">One-Line Installation</a><ul>
                    <li>
                        <a href="#step-1-open-your-terminal" aria-label="Step 1: Open Your Terminal">Step 1: Open Your Terminal</a></li>
                    <li>
                        <a href="#step-2-copy-and-paste-the-installation-command" aria-label="Step 2: Copy and Paste the Installation Command">Step 2: Copy and Paste the Installation Command</a></li>
                    <li>
                        <a href="#step-3-what-you-ll-see-during-installation" aria-label="Step 3: What You&rsquo;ll See During Installation">Step 3: What You&rsquo;ll See During Installation</a></li></ul>
                    </li>
                    <li>
                        <a href="#pip-installation" aria-label="Pip Installation">Pip Installation</a></li>
                    <li>
                        <a href="#initial-connection-to-the-egm-4" aria-label="Initial Connection to the EGM-4">Initial Connection to the EGM-4</a></li></ul>
                    </li>
                    <li>
                        <a href="#egm-4-hardware" aria-label="EGM-4 hardware">EGM-4 hardware</a><ul>
                    <li>
                        <a href="#physical-interface-and-controls" aria-label="Physical Interface &amp; Controls">Physical Interface &amp; Controls</a></li>
                    <li>
                        <a href="#power-and-battery" aria-label="Power &amp; Battery">Power &amp; Battery</a></li>
                    <li>
                        <a href="#src-1-soil-respiration-chamber" aria-label="SRC-1 Soil Respiration Chamber">SRC-1 Soil Respiration Chamber</a></li></ul>
                    </li>
                    <li>
                        <a href="#open-egm4-software" aria-label="open-egm4 software">open-egm4 software</a><ul>
                    <li>
                        <a href="#connection-screen" aria-label="Connection screen">Connection screen</a></li>
                    <li>
                        <a href="#main-interface" aria-label="Main interface">Main interface</a><ul>
                    <li>
                        <a href="#keyboard-commands" aria-label="Keyboard Commands">Keyboard Commands</a></li>
                    <li>
                        <a href="#exporting-data" aria-label="Exporting data">Exporting data</a></li>
                    <li>
                        <a href="#pausing--p" aria-label="Pausing (p)">Pausing (p)</a></li>
                    <li>
                        <a href="#adding-notes--n" aria-label="Adding notes (n)">Adding notes (n)</a></li>
                    <li>
                        <a href="#static-sampling-mode--m-n-x" aria-label="Static sampling mode (m, n, x)">Static sampling mode (m, n, x)</a></li>
                    <li>
                        <a href="#clearing-data--c" aria-label="Clearing data (c)">Clearing data (c)</a></li></ul>
                    </li>
                    <li>
                        <a href="#quitting--q" aria-label="Quitting (q)">Quitting (q)</a></li></ul>
                    </li>
                    <li>
                        <a href="#workflows" aria-label="Workflows">Workflows</a><ul>
                    <li>
                        <a href="#workflow-1-soil-respiration-with-src-1-chamber" aria-label="Workflow 1: Soil Respiration with SRC-1 Chamber">Workflow 1: Soil Respiration with SRC-1 Chamber</a></li>
                    <li>
                        <a href="#workflow-2-static-sampling-via-syringe-injection" aria-label="Workflow 2: Static Sampling via Syringe Injection">Workflow 2: Static Sampling via Syringe Injection</a></li></ul>
                    </li>
                    <li>
                        <a href="#troubleshooting-and-maintenance" aria-label="Troubleshooting &amp; Maintenance">Troubleshooting &amp; Maintenance</a><ul>
                    <li>
                        <a href="#replacing-the-soda-lime-co-scrubber" aria-label="Replacing the Soda Lime CO₂ Scrubber">Replacing the Soda Lime CO₂ Scrubber</a></li>
                    <li>
                        <a href="#replacing-the-internal-battery" aria-label="Replacing the Internal Battery">Replacing the Internal Battery</a></li>
                    <li>
                        <a href="#replacing-internal-tubing" aria-label="Replacing internal tubing">Replacing internal tubing</a></li>
                    <li>
                        <a href="#egm-4-error-codes" aria-label="EGM-4 error codes">EGM-4 error codes</a></li>
                    <li>
                        <a href="#software-connection-issues" aria-label="Software Connection Issues">Software Connection Issues</a></li></ul>
                    </li>
                    <li>
                        <a href="#technical-appendix" aria-label="Technical Appendix">Technical Appendix</a><ul>
                    <li>
                        <a href="#a-serial-protocol-specification" aria-label="A: Serial Protocol Specification">A: Serial Protocol Specification</a></li>
                    <li>
                        <a href="#b-flux-calculation-methods" aria-label="B: Flux Calculation Methods">B: Flux Calculation Methods</a><ul>
                    <li>
                        <a href="#linear-vs-dot-quadratic" aria-label="Linear vs. Quadratic">Linear vs. Quadratic</a></li>
                    <li>
                        <a href="#chamber-corrections" aria-label="Chamber Corrections">Chamber Corrections</a></li>
                    <li>
                        <a href="#worked-example" aria-label="Worked Example">Worked Example</a></li></ul>
                    </li>
                    <li>
                        <a href="#c-probe-types-reference--0-11" aria-label="C: Probe Types Reference (0-11)">C: Probe Types Reference (0-11)</a></li>
                    <li>
                        <a href="#d-water-vapor-and-temperature-corrections" aria-label="D: Water Vapor &amp; Temperature Corrections">D: Water Vapor &amp; Temperature Corrections</a></li>
                    <li>
                        <a href="#e-chamber-volume-calculations" aria-label="E: Chamber Volume Calculations">E: Chamber Volume Calculations</a></li>
                    <li>
                        <a href="#f-open-egm4-software-design-philosophy" aria-label="F: open-egm4 Software Design Philosophy">F: open-egm4 Software Design Philosophy</a><ul>
                    <li>
                        <a href="#why-a-terminal-interface" aria-label="Why a Terminal Interface?">Why a Terminal Interface?</a></li>
                    <li>
                        <a href="#advantages-over-legacy-windows-software" aria-label="Advantages Over Legacy Windows Software">Advantages Over Legacy Windows Software</a>
                    </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
            </nav>
        </aside>

        
        <div class="toc-mobile-bar" id="toc-mobile-bar">
            <button class="toc-mobile-toggle" id="toc-mobile-toggle">
                <span class="toc-mobile-label">
                    <span class="toc-mobile-parent" id="toc-mobile-parent"></span>
                    <span class="toc-mobile-current" id="toc-mobile-current">Contents</span>
                </span>
                <svg class="toc-mobile-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 9l6 6 6-6" />
                </svg>
            </button>
            <nav class="toc-mobile-nav" id="toc-mobile-nav">
                <ul><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#introduction">Introduction</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#installing-open-egm4">Installing open-egm4</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#one-line-installation">One-Line Installation</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#step-1-open-your-terminal">Step 1: Open Your Terminal</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#step-2-copy-and-paste-the-installation-command">Step 2: Copy and Paste the Installation Command</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#step-3-what-you-ll-see-during-installation">Step 3: What You&rsquo;ll See During Installation</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#pip-installation">Pip Installation</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#initial-connection-to-the-egm-4">Initial Connection to the EGM-4</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#egm-4-hardware">EGM-4 hardware</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#physical-interface-and-controls">Physical Interface &amp; Controls</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#power-and-battery">Power &amp; Battery</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#src-1-soil-respiration-chamber">SRC-1 Soil Respiration Chamber</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#open-egm4-software">open-egm4 software</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#connection-screen">Connection screen</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#main-interface">Main interface</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#keyboard-commands">Keyboard Commands</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#exporting-data">Exporting data</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#pausing--p">Pausing (<code>p</code>)</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#adding-notes--n">Adding notes (<code>n</code>)</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#static-sampling-mode--m-n-x">Static sampling mode (<code>m</code>, <code>n</code>, <code>x</code>)</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#clearing-data--c">Clearing data (<code>c</code>)</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#quitting--q">Quitting (<code>q</code>)</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#workflows">Workflows</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#workflow-1-soil-respiration-with-src-1-chamber">Workflow 1: Soil Respiration with SRC-1 Chamber</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#workflow-2-static-sampling-via-syringe-injection">Workflow 2: Static Sampling via Syringe Injection</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#troubleshooting-and-maintenance">Troubleshooting &amp; Maintenance</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#replacing-the-soda-lime-co-scrubber">Replacing the Soda Lime CO₂ Scrubber</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#replacing-the-internal-battery">Replacing the Internal Battery</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#replacing-internal-tubing">Replacing internal tubing</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#egm-4-error-codes">EGM-4 error codes</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#software-connection-issues">Software Connection Issues</a>
                        </li><li class="toc-mobile-item level-2" data-level="2">
                            <a href="#technical-appendix">Technical Appendix</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#a-serial-protocol-specification">A: Serial Protocol Specification</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#b-flux-calculation-methods">B: Flux Calculation Methods</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#linear-vs-dot-quadratic">Linear vs. Quadratic</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#chamber-corrections">Chamber Corrections</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#worked-example">Worked Example</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#c-probe-types-reference--0-11">C: Probe Types Reference (0-11)</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#d-water-vapor-and-temperature-corrections">D: Water Vapor &amp; Temperature Corrections</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#e-chamber-volume-calculations">E: Chamber Volume Calculations</a>
                        </li><li class="toc-mobile-item level-3" data-level="3">
                            <a href="#f-open-egm4-software-design-philosophy">F: open-egm4 Software Design Philosophy</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#why-a-terminal-interface">Why a Terminal Interface?</a>
                        </li><li class="toc-mobile-item level-4" data-level="4">
                            <a href="#advantages-over-legacy-windows-software">Advantages Over Legacy Windows Software</a>
                        </li></ul>
            </nav>
        </div>

        <article class="post-single">
            <header class="post-header">
                <div class="breadcrumbs"><a href="https://docs.mor-gan.com/">Home</a>&nbsp;»&nbsp;<a href="https://docs.mor-gan.com/posts/">Posts</a></div>
                <h1 class="post-title entry-hint-parent">
                    Using the EGM-4 &amp; open-egm4 software
                </h1>
                <div class="post-meta"><span title='2026-02-01 15:25:00 -0600 CST'>February 1, 2026</span>&nbsp;·&nbsp;<span>40 min</span>&nbsp;|&nbsp;<span>
    <a href="https://github.com/mmorgans/docs/tree/main/content/posts/using-the-egm-4.md" rel="noopener noreferrer edit" target="_blank">suggest changes</a>
</span>

</div>
            </header> 
            <div class="post-content"><div class="alert alert-Warning">
  <strong>Backup your data regularly.</strong>  The EGM-4&rsquo;s internal memory is limited to 1,500 records across up to 99 plots. Failing to dump data regularly will result in data loss when this buffer fills. When memory is full, the oldest records are overwritten.
</div>
<div class="alert alert-Warning">
  <strong>You are responsible for your data.</strong> Significant care has been taken to ensure data safety. However, by using the open-egm4 software, you accept the risk of data loss. Open-egm4 can not send commands to the EGM-4 itself, and therefore cannot damage it internally.
</div>
<div class="alert alert-Caution">
  <strong>Don&rsquo;t get water in the gas lines.</strong> If you do, it might enter the IRGA itself and damage it. It&rsquo;s like $15,000 to replace.
</div>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>The PP Systems EGM-4 (EGM) is a portable infrared gas analyzer (IRGA) designed for measuring soil CO₂ efflux. The device connects to various chamber types and soil probes, and stores measurements in its internal memory.</p>
<p>The open-egm4 software is a terminal interface designed to make data collection from the EGM reliable and easy. Unlike the legacy (read: outdated, buggy and frustrating) Windows software from PP Systems, this runs on macOS, Linux, and modern Windows systems.</p>
<p>This guide covers operation of the EGM itself, the SRC-1 chamber, how to use them alongside the open-egm4 software, common field scenarios and troubleshooting everything involved.</p>
<h2 id="installing-open-egm4">Installing open-egm4<a hidden class="anchor" aria-hidden="true" href="#installing-open-egm4">#</a></h2>
<p><strong>What is open-egm4?</strong></p>
<ul>
<li>A terminal-based (text interface) application that communicates with the EGM</li>
<li>Provides real-time CO₂ visualization, data logging, and exporting of said data to a csv</li>
<li>Works on any modern operating system</li>
<li>Can run over SSH for remote field work (if anyone thinks of a genuine use case for this <a href="mailto:egm4@mor-gan.com">please tell me</a>)</li>
</ul>
<p><strong>What is a Terminal?</strong>
A terminal (also called &ldquo;command line&rdquo; or &ldquo;shell&rdquo;) is a text-based interface for your computer. Think of it as typing commands directly to your computer instead of clicking on icons. Using a computer through the terminal (or, pedantically, <em>it&rsquo;s</em> terminal) typically gives you much greater control and choice over its operation. In this case, open-egm4 was developed as a TUI (<em>terminal user interface</em>: an app that runs inside of the terminal) because it allows the app to be significantly smaller, more portable, and more lightweight to run on underpowered computers.</p>
<p>For more information on my debatable decision to develop the app for the terminal, see <a href="#why-a-terminal-interface">the appendix</a>.</p>
<p><strong>System Requirements:</strong></p>
<ul>
<li>macOS 10.14+, Windows 10+, or any modern Linux</li>
<li>Python 3.8+ (the installer handles this automatically)</li>
<li>USB serial port or USB-to-serial adapter
<ul>
<li><em>Note</em> If you are buying a USB-serial adapter, make sure to get one that uses a FTDI chipset. Cheap adapters often use &ldquo;Prolific&rdquo; chips which have notoriously bad drivers. FTDI chips are easier and require zero thought to use.</li>
</ul>
</li>
<li>Internet connection (for installation only)</li>
</ul>
<h3 id="one-line-installation">One-Line Installation<a hidden class="anchor" aria-hidden="true" href="#one-line-installation">#</a></h3>
<p>This is the easiest method. A script handles everything: installing Python dependencies, downloading the software, and setting up shortcuts so you can run <code>open-egm4</code> from anywhere.</p>
<h4 id="step-1-open-your-terminal">Step 1: Open Your Terminal<a hidden class="anchor" aria-hidden="true" href="#step-1-open-your-terminal">#</a></h4>
<p><strong>macOS:</strong></p>
<ol>
<li>Press <code>Cmd + Space</code> to open Spotlight search.</li>
<li>Type &ldquo;Terminal&rdquo;</li>
<li>Press Enter</li>
<li>A window with white or black background appears—this is your terminal.</li>
</ol>
<p><strong>Windows:</strong></p>
<ol>
<li>Click the Start Menu (Windows logo)</li>
<li>Type &ldquo;PowerShell&rdquo;</li>
<li>Press Enter</li>
<li>A window appears with text—this is your terminal (command prompt is also a terminal, but it is exclusive to Windows; it has also been around since the 80s: PowerShell is Microsoft&rsquo;s attempt at an updated terminal for Windows.)</li>
</ol>
<p><strong>Linux:</strong>
You already know how to open a terminal.</p>
<h4 id="step-2-copy-and-paste-the-installation-command">Step 2: Copy and Paste the Installation Command<a hidden class="anchor" aria-hidden="true" href="#step-2-copy-and-paste-the-installation-command">#</a></h4>
<div class="alert alert-Caution">
  <strong>With great power&hellip;</strong> Entering commands into a terminal gives you much more control over your computer than most users are used to. While this power is beneficial for knowledgeable users, it also makes it easy to make potentially irreversible mistakes.
</div>
<div class="alert alert-Warning">
  <strong>&hellip;comes great responsibility.</strong> You should never copy and paste commands into your terminal from sources you do not trust. A malicious command could delete files, install malware, or send your data to an attacker. While <strong>I</strong> wrote this script, you are ultimately trusting <em>me</em> not to do something harmful. You can (and really should) view the install script source before running it.
</div>
<p>In your terminal window, copy and paste this line as written:</p>
<p><strong>macOS / Linux:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -sSL https://raw.githubusercontent.com/mmorgans/open-egm4/main/install.sh | bash
</span></span></code></pre></div><p><strong>Windows (PowerShell):</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>irm https<span style="color:#960050;background-color:#1e0010">:</span>//raw.githubusercontent.com/mmorgans/open-egm4/main/install.ps1 | iex
</span></span></code></pre></div><p><strong>How to Paste in Terminal:</strong></p>
<ul>
<li><strong>macOS</strong>: Press <code>Cmd + V</code> (normal paste works)</li>
<li><strong>Windows (PowerShell)</strong>: Right-click to paste, OR <code>Ctrl + Shift + V</code></li>
<li><strong>Linux</strong>: <code>Ctrl + Shift + V</code> (not <code>Ctrl + V</code>!)</li>
</ul>
<p>Press <code>Enter</code> to run the command.</p>
<div class="alert alert-Note">
  Running the installation script when open-egm4 is already installed allows you to update, repair, or uninstall the software.
</div>
<h4 id="step-3-what-you-ll-see-during-installation">Step 3: What You&rsquo;ll See During Installation<a hidden class="anchor" aria-hidden="true" href="#step-3-what-you-ll-see-during-installation">#</a></h4>
<p>After pressing Enter, text will start scrolling down the screen. You&rsquo;ll see messages like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[INFO] Checking prerequisites...
</span></span><span style="display:flex;"><span>[INFO] Installing fresh to /Users/hello/.open-egm4...
</span></span><span style="display:flex;"><span>[INFO] Creating virtual environment...
</span></span><span style="display:flex;"><span>[INFO] Fetching latest version and installing dependencies...
</span></span></code></pre></div><p>The installation takes 1-3 minutes depending on your internet speed. When you see &ldquo;Installation Complete&rdquo;, it&rsquo;s done.</p>
<p><strong>Troubleshooting</strong>:</p>
<ul>
<li>On Linux, you might need to add your user to the <code>dialout</code> group to access the serial port. You can do this with the command <code>sudo usermod -a -G dialout $USER</code></li>
<li>If you see &ldquo;curl: command not found&rdquo; on Windows, try using PowerShell instead of cmd</li>
<li>If you see &ldquo;Python not found&rdquo;, the installer will attempt to install it automatically</li>
<li>If installation fails, try the manual installation below. If it still doesn&rsquo;t work, <a href="mailto:egm4@mor-gan.com">shoot me an email</a> and I&rsquo;ll try to help.</li>
</ul>
<h3 id="pip-installation">Pip Installation<a hidden class="anchor" aria-hidden="true" href="#pip-installation">#</a></h3>
<p>If you&rsquo;re comfortable with Python environments:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Install via pipx (recommended for isolation)</span>
</span></span><span style="display:flex;"><span>pipx install git+https://github.com/mmorgans/open-egm4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># OR install in your active virtual environment</span>
</span></span><span style="display:flex;"><span>pip install git+https://github.com/mmorgans/open-egm4
</span></span></code></pre></div><p>If you want to edit the code of open-egm4, there are more instructions on <a href="https://github.com/mmorgans/open-egm4">the repository page</a>.</p>
<h3 id="initial-connection-to-the-egm-4">Initial Connection to the EGM-4<a hidden class="anchor" aria-hidden="true" href="#initial-connection-to-the-egm-4">#</a></h3>
<p>Once software is installed, connect the EGM to a computer:</p>
<ol>
<li><strong>Physical Connection:</strong>
<ul>
<li>Connect the serial cable to the EGM&rsquo;s RS232 port</li>
<li>Connect the USB-to-serial adapter to your computer</li>
<li>Power on the EGM with the switch on the back</li>
</ul>
</li>
</ol>
<div class="alert alert-Note">
  <p>When the EGM-4 boots, pay attention to the startup screen values. For example:</p>
<p><code>C 2000 5V=2000</code></p>
<p><code>Probetype 8 R248</code></p>
<p>This is useful because it tells you how that specific instrument is calibrated. In this example, <code>C 2000</code> indicates the analyzer is calibrated to a 2000 ppm range.</p>

</div>
<ol start="2">
<li><strong>Launch the Software:</strong></li>
</ol>
<p>On your computer, in the terminal, run</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>open-egm4
</span></span></code></pre></div><ol>
<li><strong>Select Serial Port:</strong>
<ul>
<li>The software will list available serial ports (e.g., <code>/dev/tty.usbserial</code>, <code>COM3</code>)</li>
<li>It will also attempt to guess at which one the EGM is connected to and automatically connect to it</li>
<li>If it doesn&rsquo;t, select the port manually using the arrow keys, and hit Enter to confirm your choice. If you don&rsquo;t see your port listed, check the cable connection and hit <code>r</code> on your keyboard to refresh the list of ports.</li>
<li>On macOS, look for ports containing &ldquo;usbserial&rdquo; or &ldquo;FTDI&rdquo;</li>
<li>On Windows, look for &ldquo;COM&rdquo; ports (COM3, COM4, etc.)</li>
</ul>
</li>
</ol>
<div class="alert alert-Note">
  Windows lacks default braille support, so <code>open-egm4</code> automatically uses lower-detail symbols if running on Windows. If you install a compatible font, launch open-egm4 with the  <code>--force-unicode</code> flag to enable high-detail braille graphs. You can see which platform and graphics mode open-egm4 is using on the splash screen.
</div>
<ol>
<li>
<p><strong>Verify Connection:</strong></p>
<ul>
<li>The EGM screams out data over the serial connection, but it&rsquo;s incapable of receiving any data back. Therefore, you&rsquo;ll have no way of knowing if you&rsquo;re actually connected to the EGM unless you dump some data to your computer.</li>
<li>Details on how to collect data are <a href="#exporting-data">in the workflow section</a>, but for now you can verify that the software was installed correctly by dumping existing data from the EGM to your computer, assuming that there is pre-existing data on the EGM.</li>
<li>To send data from the EGM to a computer, press <code>4DMP</code> on the EGM, then <code>2 DATA DUMP</code>, then press any key to begin the transfer.</li>
<li>If you see the data streaming in on your computer, celebrate. If you don&rsquo;t, then check out <a href="#troubleshooting-and-maintenance">the troubleshooting section</a>.</li>
</ul>
</li>
<li>
<p><strong>Press <code>q</code> to quit</strong> (or <code>Ctl + c</code>, which should quit most running terminal commands) when you&rsquo;re done exploring.</p>
</li>
</ol>
<h2 id="egm-4-hardware">EGM-4 hardware<a hidden class="anchor" aria-hidden="true" href="#egm-4-hardware">#</a></h2>
<h3 id="physical-interface-and-controls">Physical Interface &amp; Controls<a hidden class="anchor" aria-hidden="true" href="#physical-interface-and-controls">#</a></h3>
<p>The EGM-4 is a portable, battery-powered CO₂ analyzer. Key components:</p>
<p><strong>Front Panel:</strong></p>
<ul>
<li><strong>LCD Display</strong>: 2×16 character display</li>
<li>1-9 keypad, along with <code>Y/R</code> key (used for accepting and recording) and <code>N</code> key (used for denying and going back)</li>
<li><code>8/X</code> allows you to toggle between display screens while taking a measurement</li>
<li><code>0/Z</code> allows you to manually zero the EGM-4 during a measurement</li>
</ul>
<p><strong>Top:</strong></p>
<ul>
<li><strong>Gas In Port</strong>: Connect sample inlet tubing (1/8&quot; ID)</li>
<li><strong>Gas Out Port</strong>: Exhaust port (1/8&quot; ID) AND (counter-intuitively) should be used as an injection port for static syringe samples</li>
<li><strong>I/O Connectors</strong>: Two 15-pin D-sub connectors for sensors (notably the SRC-1)</li>
<li><strong>RS232 Port</strong>: 9-pin connector for data transfer to a computer</li>
</ul>
<p><strong>Back:</strong></p>
<ul>
<li><strong>Power Switch</strong>: Self explanatory</li>
<li><strong>12V DC Charge Socket</strong>: For charging the internal battery <em>and</em> running the EGM off of mains power</li>
<li><strong>Fuse</strong>: 1A fuse</li>
<li><strong>Soda Lime Cap</strong>: Access to the CO₂ scrubbing column for replacing it.</li>
</ul>
<h3 id="power-and-battery">Power &amp; Battery<a hidden class="anchor" aria-hidden="true" href="#power-and-battery">#</a></h3>
<p>The EGM-4 uses a 12V 2.0Ah sealed lead-acid battery. It should last around 4 hours of use at 20ºC. If the temperature is below 5ºC, the battery life drops 30-40%.</p>
<div class="alert alert-Note">
  At low temperatures, you should hold the EGM inside your jacket, maintaining skin-to-skin contact. This will increase the battery life by a few minutes, and will psychologically bond you with the device.
</div>
<p><strong>Charging:</strong> The manual purports that the battery takes 12 hours to charge fully. <em>I</em> think that&rsquo;s a made up number, and in my testing it&rsquo;s ready for action after around 2 hours. Your mileage may vary.</p>
<p>If you are planning on storing the EGM long term, charge the battery beforehand to avoid damaging it.</p>
<div class="alert alert-Warning">
  The EGM&rsquo;s internal clock loses time when the battery dies. After replacing or fully recharging the battery, make sure the date/time settings are correct before taking measurements. This is critical for ensuring that your data is properly timestamped.
</div>
<p><strong>Replacement:</strong> To replace the battery, see <a href="#troubleshooting-and-maintenance">the troubleshooting section</a>.</p>
<h3 id="src-1-soil-respiration-chamber">SRC-1 Soil Respiration Chamber<a hidden class="anchor" aria-hidden="true" href="#src-1-soil-respiration-chamber">#</a></h3>
<p>The SRC-1 is a soil respiration chamber that allows you to measure the rate of soil respiration by monitoring the rate of increase of CO₂ concentration within a closed system: the chamber itself. See the <a href="#workflow-1-soil-respiration-with-src-1-chamber">SRC-1 Workflow section.</a></p>
<h2 id="open-egm4-software">open-egm4 software<a hidden class="anchor" aria-hidden="true" href="#open-egm4-software">#</a></h2>
<p>This section covers how to use the open-egm4 software, assuming you&rsquo;ve already installed it.</p>
<p>Launch the software by running <code>open-egm4</code> in your terminal.</p>
<h3 id="connection-screen">Connection screen<a hidden class="anchor" aria-hidden="true" href="#connection-screen">#</a></h3>
<p>When you launch the software, you&rsquo;ll see the connection screen, with a list of ports.</p>
<p><picture>
  <source srcset="/images/egm4/connect-screen.webp" type="image/webp">
  <img alt="open-egm4 connection screen with detected serial ports" decoding="async" loading="lazy" src="/images/egm4/connect-screen.png">
</picture></p>
<p>Open-egm4 will attempt to detect which port the EGM-4 is connected to and automatically connect to it after 5 seconds. Use the arrow keys to cancel this countdown and select a port manually.</p>
<p>To select a port manually, use the arrow keys to navigate the list of ports and press <code>Enter</code> to confirm your selection. If you don&rsquo;t see your port listed, check the cable connection and hit <code>r</code> on your keyboard to refresh the list of ports. If you accidentally select the wrong port, hit <code>q</code> to quit and try again.</p>
<ul>
<li>On macOS and Linux, the EGM-4 will likely appear as a port containing &ldquo;usbserial&rdquo; or &ldquo;FTDI&rdquo;</li>
<li>On Windows, the EGM-4 will likely appear as a &ldquo;COM&rdquo; port (COM3, COM4, etc.)</li>
</ul>
<p>Open-egm4 automatically saves data to its internal database. This allows you to restore from a previous session without having to re-dump data from the EGM. To do this, press <code>s</code> while on the connection screen. You&rsquo;ll see a list of saved sessions, and you can use the arrow keys to select one and press <code>Enter</code> to restore it. You do not need to have the EGM connected to the computer to restore a session. While the EGM is not connected, &ldquo;Offline&rdquo; will be displayed in the status panel.</p>
<h3 id="main-interface">Main interface<a hidden class="anchor" aria-hidden="true" href="#main-interface">#</a></h3>
<p>This is the main interface, where you&rsquo;ll spend most of your time. It consists of:</p>
<p><picture>
  <source srcset="/images/egm4/main-interface.webp" type="image/webp">
  <img alt="open-egm4 main interface (graph, status, and log panels)" decoding="async" loading="lazy" src="/images/egm4/main-interface.png">
</picture></p>
<p><strong>Left Panel - Graph:</strong> This panel displays incoming data from the EGM, whether it be from a live measurement or previously generated data. The axes will automatically rescale to fit the data. The units will also change depending on how you are viewing the data, so be sure to check the legend to understand what you&rsquo;re looking at.</p>
<p>Directly below the graph are the available channels and graph controls. The available channels will change depending on what probe was connected when the the data was recorded. Press the number key associated with each channel to view that channel in the graph.</p>
<p>Above the graph, you&rsquo;ll see information about what the graph is currently displaying, including the currently selected channel, the units of the y-axis, and the plot number.</p>
<p>Press the <code>&lt;</code> or <code>&gt;</code> keys to cycle through different plots. This is useful to view measurements from a specific location (i.e. a plot in the field), and to filter out data you aren&rsquo;t interested in viewing.</p>
<p>Press <code>i</code> to toggle inspect mode on the graph. In this mode, a yellow <code>x</code> appears on the graph, and you can use the left and right arrow keys to move the cursor along the x-axis. The y-values for the currently selected channel at the cursor&rsquo;s position are displayed above the graph. Press <code>i</code> again to exit inspect mode.</p>
<p><strong>Right Panels - Status and Log:</strong> These panels display the current status of the EGM and the log of recent events. The status panel shows the current CO₂ concentration, along with derived statistics from that value. The log panel shows EGM system messages and app events.</p>
<p><strong>Footer:</strong> The footer displays a list of all commands, along with their keyboard shortcuts.</p>
<h4 id="keyboard-commands">Keyboard Commands<a hidden class="anchor" aria-hidden="true" href="#keyboard-commands">#</a></h4>
<table>
  <thead>
      <tr>
          <th>Key</th>
          <th>Action</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>q</code></td>
          <td>Quit</td>
          <td>Saves and exits as quickly as possible</td>
      </tr>
      <tr>
          <td><code>e</code></td>
          <td>Export</td>
          <td>Opens the export screen to save data as CSV</td>
      </tr>
      <tr>
          <td><code>c</code></td>
          <td>Clear</td>
          <td>Clears all chart data (with confirmation)</td>
      </tr>
      <tr>
          <td><code>p</code></td>
          <td>Pause</td>
          <td>Pauses/resumes the data stream</td>
      </tr>
      <tr>
          <td><code>n</code></td>
          <td>Note</td>
          <td>Add a timestamped note to the log</td>
      </tr>
      <tr>
          <td><code>b</code></td>
          <td>Big Mode</td>
          <td>Large CO₂ display for visibility outdoors</td>
      </tr>
      <tr>
          <td><code>d</code></td>
          <td>Theme</td>
          <td>Toggle between dark and light themes</td>
      </tr>
      <tr>
          <td><code>i</code></td>
          <td>Inspect</td>
          <td>Toggleable mode to examine individual points</td>
      </tr>
      <tr>
          <td><code>?</code></td>
          <td>Help</td>
          <td>Information about the app</td>
      </tr>
      <tr>
          <td><code>1</code> - <code>9</code></td>
          <td>Switch between data channels</td>
          <td></td>
      </tr>
      <tr>
          <td><code>,</code> / <code>.</code></td>
          <td>Cycle between different plots</td>
          <td></td>
      </tr>
      <tr>
          <td><code>&lt;</code> / <code>&gt;</code></td>
          <td>Same as above: plot selection</td>
          <td></td>
      </tr>
      <tr>
          <td><code>←</code> / <code>→</code></td>
          <td>Move cursor (when in Inspect mode)</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h4 id="exporting-data">Exporting data<a hidden class="anchor" aria-hidden="true" href="#exporting-data">#</a></h4>
<p>Press <code>e</code> to open the export screen. This allows you to filter and export your data.</p>
<p><picture>
  <source srcset="/images/egm4/exporting.webp" type="image/webp">
  <img alt="open-egm4 export screen after selecting data filters" decoding="async" loading="lazy" src="/images/egm4/exporting.png">
</picture></p>
<p>At the top of the export screen, you&rsquo;ll see the number of data currently selected to export. Initially, this will be all of the data currently in the app.</p>
<p><strong>Filtering data</strong>
To export only a subset of that data, use the <code>p</code> and <code>d</code> keys to select only certain plots and dates, respectively.</p>
<p>To select specific plots to export, press <code>p</code> to open the plot selection screen. Use the arrow keys to navigate the list of plots and press <code>Space</code> to select or deselect a plot. Press <code>p</code> again to confirm and return to the export screen.</p>
<p>To select specific dates to export, press <code>d</code> to open the date selection screen. Use the arrow keys to navigate the list of dates and press <code>Space</code> to select or deselect a date. Press <code>d</code> again to confirm and return to the export screen.</p>
<p>You should see the number of data points to export update as you make your selections. Once you&rsquo;ve selected the data you want to export, press <code>e</code> to export the data.</p>
<p><strong>Output</strong>
.csv files should be saved to your Downloads directory. If this fails, the file will be saved in the same directory as open-egm4 was run in (likely your home directory).</p>
<h4 id="pausing--p">Pausing (<code>p</code>)<a hidden class="anchor" aria-hidden="true" href="#pausing--p">#</a></h4>
<p>Press <code>p</code> to pause the data stream. While paused, the chart will stop updating with data, but you can still interact with the app. This is useful if you need to examine the chart without it updating with new data. Press <code>p</code> again to resume the data stream.</p>
<h4 id="adding-notes--n">Adding notes (<code>n</code>)<a hidden class="anchor" aria-hidden="true" href="#adding-notes--n">#</a></h4>
<p>Press <code>n</code> to add a timestamped note to the log. This will open a prompt where you can type a note. Press <code>Enter</code> to save the note, or <code>Esc</code> to cancel.</p>
<h4 id="static-sampling-mode--m-n-x">Static sampling mode (<code>m</code>, <code>n</code>, <code>x</code>)<a hidden class="anchor" aria-hidden="true" href="#static-sampling-mode--m-n-x">#</a></h4>
<p>Static sampling mode guides syringe-injection sampling directly from the monitor screen.</p>
<ul>
<li>Press <code>m</code> to toggle static sampling mode on or off.</li>
<li>When enabled, the stats panel shows <code>STATIC SAMPLING</code> and the current step prompt.</li>
<li>Press <code>n</code> to advance the guided cycle:
<ul>
<li><code>STEP 1: INJECT SAMPLE (N)</code></li>
<li><code>STEP 2: WAIT TO SETTLE, CAPTURE (N)</code></li>
<li><code>STEP 3: INJECT AMBIENT AIR (N)</code></li>
</ul>
</li>
<li>During Step 2, pressing <code>n</code> opens a label prompt for the sample. You can leave it blank to auto-name the sample.</li>
<li>open-egm4 records both the settled concentration and the post-injection peak concentration for each captured sample.</li>
<li>Press <code>x</code> at any time to reset the cycle back to Step 1.</li>
<li>Exported CSV files include static sample rows (<code>type=SAMPLE</code>) with <code>sample_id</code>, <code>sample_label</code>, <code>sample_ppm</code>, and <code>sample_peak_ppm</code>.</li>
</ul>
<h4 id="clearing-data--c">Clearing data (<code>c</code>)<a hidden class="anchor" aria-hidden="true" href="#clearing-data--c">#</a></h4>
<p>Press <code>c</code> to clear all data from the current session. You will be asked to confirm before the data is cleared.</p>
<div class="alert alert-Note">
  This does not clear data from the EGM&rsquo;s internal memory, only data that you have already dumped to the app. To clear data from the EGM&rsquo;s internal memory, see the initialize section.
</div>
<h3 id="quitting--q">Quitting (<code>q</code>)<a hidden class="anchor" aria-hidden="true" href="#quitting--q">#</a></h3>
<p>Press <code>q</code> to quit the app. All data from your session are automatically saved (distinct from .csv files you may have exported), and you can restore it the next time you open the app by pressing <code>s</code> while on the connection screen.</p>
<div class="alert alert-Note">
  Open-egm4 automatically saves data to an internal database. To restore from a previous session, see <a href="#connection-screen">the connection screen section</a>.
</div>
<h2 id="workflows">Workflows<a hidden class="anchor" aria-hidden="true" href="#workflows">#</a></h2>
<h3 id="workflow-1-soil-respiration-with-src-1-chamber">Workflow 1: Soil Respiration with SRC-1 Chamber<a hidden class="anchor" aria-hidden="true" href="#workflow-1-soil-respiration-with-src-1-chamber">#</a></h3>
<p>This is the most common application: measuring CO₂ efflux from soil using the SRC-1 closed-chamber method.</p>
<p><strong>Equipment Needed:</strong></p>
<ul>
<li>EGM-4 with fully charged battery</li>
<li>SRC-1 soil respiration chamber</li>
<li>Soil collars*</li>
<li>Optional: Laptop running open-egm4 for monitoring</li>
</ul>
<p><strong>Soil Collars</strong>: Install the soil collars well before you plan to measure (this should be planned prior to doing field work). A well-placed collar should be installed 3-5cm deep into the soil surface. Remove any aboveground vegetation inside the collar.</p>
<div class="alert alert-Note">
  The above instructions depend almost <em>entirely</em> on your situation. You might consider installing the soil collar weeks or months ahead of time. The depth of the collar needed to ensure a good measurement will depend on the soil type and the goals of your experiment.
</div>
<p><strong>Field Procedure:</strong></p>
<ol>
<li>
<p><strong>Connect SRC-1 to EGM-4:</strong></p>
<ul>
<li>Connect the I/O cable of the SRC-1 to the EGM-4</li>
<li>Connect the gas tube labeled &ldquo;R&rdquo; to the gas in port of the EGM-4</li>
<li>Connect the unlabeled gas tube to the gas out port of the EGM-4</li>
</ul>
</li>
<li>
<p><strong>Startup &amp; Warmup (10-15 minutes):</strong></p>
<ul>
<li>Power on the EGM</li>
<li>Wait for warm-up message to complete: the EGM must reach an internal temperature of 55°C to be able to take readings</li>
</ul>
</li>
<li>
<p><strong>Enter Measurement Mode:</strong></p>
<ul>
<li>Press <code>1</code> (REC) from the main menu</li>
<li>The EGM will display measurement settings</li>
<li>Default: DT=120 seconds (measurement duration), DC=50 ppm (max CO₂ change)</li>
<li>Press <code>N</code> to change settings, or <code>Y</code> to confirm and continue</li>
</ul>
</li>
<li>
<p><strong>Select Fitting Method:</strong></p>
<ul>
<li>After confirming settings, the EGM will display <code>1LINEAR 2QUAD?</code></li>
<li>Press <code>1</code> for <strong>Linear Fit</strong>: Best for short measurements (under 2 minutes) or low-flux soils</li>
<li>Press <code>2</code> for <strong>Quadratic Fit</strong>: Better for longer measurements or high-flux soils where CO₂ buildup may cause the flux rate to level off</li>
</ul>
</li>
</ol>
<div class="alert alert-Note">
  Linear fitting assumes a constant flux rate throughout the measurement. Quadratic fitting accounts for the natural slowdown that occurs as CO₂ builds up in the chamber. If you&rsquo;re unsure, quadratic is generally safer for measurements over 2 minutes. See <a href="#b-flux-calculation-methods">Appendix B</a> for the math behind each method.
</div>
<div class="alert alert-Note">
  You should think carefully about the DT value that you set for a given measurement, especially if you selected a linear fit. If the DT value is too large the rate at which CO₂ accumulates in the chamber will decline, and your estimate of the efflux rate will be less accurate.
</div>
<ol>
<li><strong>Set Plot Number:</strong>
<ul>
<li>The EGM will display &ldquo;PLOT NO = X&rdquo;</li>
<li>Press <code>Y</code> to keep the current plot number</li>
<li>Or enter a new plot number (e.g., &ldquo;01&rdquo; for plot 1) and press <code>Y</code></li>
</ul>
</li>
</ol>
<div class="alert alert-Warning">
  If you use a plot number that has already been used, the EGM will overwrite the previous measurement, causing irreversible data loss.
</div>
<ol>
<li>
<p><strong>Chamber Flush:</strong></p>
<ul>
<li>This happens automatically. The EGM will display &ldquo;CHAMBER FLUSHING - HOLD IN AIR&rdquo;</li>
<li>Hold the chamber in the air for ~15 seconds at arms length</li>
</ul>
</li>
<li>
<p><strong>Deployment:</strong></p>
<ul>
<li>The EGM will display &ldquo;PLACE ON SOIL - PRESS Y TO START&rdquo;</li>
<li>Place the chamber on the soil collar, using Blu Tack on the rim of the chamber to ensure a good seal</li>
<li>Press <code>Y</code> to start measurement</li>
</ul>
</li>
<li>
<p><strong>Equilibration:</strong></p>
<ul>
<li>The EGM will display &ldquo;EQUILIBRATION - PLEASE WAIT&rdquo;</li>
<li>The system will equilibrate for ~5 seconds</li>
<li>Then measurement begins automatically</li>
</ul>
</li>
<li>
<p><strong>Measurement:</strong></p>
<ul>
<li>The EGM will display:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>          C 420 H14.7 T22
</span></span><span style="display:flex;"><span>          A02.11 Q0000 110
</span></span></code></pre></div></li>
<li><code>C</code>: Current CO₂ (ppm)</li>
<li><code>H</code>: Humidity (mb, if sensor connected)</li>
<li><code>T</code>: Soil temperature (°C, if sensor connected)</li>
<li><code>A</code>: Calculated flux rate (g CO₂ m⁻² hr⁻¹)</li>
<li><code>Q</code>: PAR light level (if sensor connected)</li>
<li><code>110</code>: Elapsed time (seconds) — shows &ldquo;END&rdquo; when complete</li>
<li>After a measurement, you will be prompted to save the measurement with &ldquo;RECORD Y/N&rdquo;</li>
<li>Press <code>Y</code> to save the measurement</li>
<li>Press <code>N</code> to discard and retry</li>
</ul>
</li>
<li>
<p><strong>Remove Chamber &amp; Continue:</strong></p>
<ul>
<li>The EGM will display &ldquo;REMOVE FROM SOIL THEN PRESS Y KEY&rdquo;</li>
<li>Lift chamber from soil collar</li>
<li>Press <code>Y</code> to prepare for the next measurement</li>
</ul>
</li>
</ol>
<div class="alert alert-Caution">
  The plot number will <strong>not</strong> auto-increment. You must manually enter the plot number for each measurement. Note that the EGM will happily overwrite the previous measurement if you don&rsquo;t change the plot number between measurements!
</div>
<p><strong>Data Viewing &amp; Storage:</strong>
Though not necessary, you can have your computer connected to the EGM while you are taking soil repisration measurements. This allows you to view the incoming the data in real time, using open-egm4, and see it graphed. This can be helpful for understanding how long it takes your soil system to produce enough CO₂ to lessen the diffusion gradient driving respiration fluxes into the chamber.</p>
<p>Regardless, because you designated a plot number before you started the measurement, the EGM will store the data in its internal memory. The EGM stores up to 1,500 records, and will start overwriting old records if full. See  <a href="#exporting-data">instructions on how to export data from the EGM</a>.</p>
<p>To transfer stored records from field plots on the EGM-4 to your computer, do the following:</p>
<ol>
<li>Connect the EGM-4 to your computer using a serial cable and USB adapter</li>
<li>Power on the EGM-4 and open the open-egm4 app on your computer by typing <code>open-egm4</code> in the terminal</li>
<li>Press <code>4DMP</code> from the Main Menu on the EGM-4, then Press <code>2 DATA DUMP</code></li>
<li>Once the open-egm4 app is ready, press any key on the EGM-4 to start the transfer</li>
<li>View your data on the graph, and use the <code>&lt;</code> and <code>&gt;</code> keys to view a specific plot</li>
<li>Press <code>e</code> to open the export menu. Use the <code>p</code> and <code>d</code> keys to select the plot(s) and/or date(s) you want to export, then press <code>e</code> to export</li>
<li>The .csv will be saved to your Downloads directory</li>
</ol>
<p><strong>Data Record Structure:</strong></p>
<p>Each record contains (in CSV format):</p>
<ul>
<li>M/R flag (M=real-time, R=stored record)</li>
<li>Plot number (0-9999)</li>
<li>Record number (1-9999)</li>
<li>Date (day, month)</li>
<li>Time (hour, minute)</li>
<li>CO₂ (ppm)</li>
<li>H₂O vapor (mb, if sensor present)</li>
<li>RH/Temp sensor data</li>
<li>Sensor inputs A-E (mV values)</li>
<li>Atmospheric pressure (mb)</li>
<li>Probe type (0-11)</li>
</ul>
<h3 id="workflow-2-static-sampling-via-syringe-injection">Workflow 2: Static Sampling via Syringe Injection<a hidden class="anchor" aria-hidden="true" href="#workflow-2-static-sampling-via-syringe-injection">#</a></h3>
<p>Static sampling is used when you want to measure CO₂ concentration of a discrete air sample without continuous flow. Common applications: measuring gas concentrations from sealed containers, soil headspace, or captured gas samples.</p>
<p>Instead of pumping air continuously through the EGM-4, you inject a small volume of sample directly into the measurement cell using a syringe. The internal pump is turned off to avoid diluting your sample.</p>
<p><strong>Equipment Needed:</strong></p>
<ul>
<li>EGM-4 with battery</li>
<li>Luer-lock syringe (5-10 ml)</li>
<li>Sample vial or other vessel from which you will take a syringe sample</li>
<li>A female luer-lock adapter to connect the syringe to the EGM</li>
<li>A computer with open-egm4 installed</li>
</ul>
<div class="alert alert-Warning">
  Ensure that water does not enter the EGM when injecting a sample. If water enters the EGM, it will damage the IRGA.
</div>
<p><strong>Setup Procedure:</strong></p>
<ol>
<li>
<p><strong>Connect to Computer:</strong></p>
<ul>
<li>Connect the EGM to your computer using a serial cable and USB adapter</li>
<li>Open the open-egm4 app on your computer by typing <code>open-egm4</code> in the terminal</li>
</ul>
</li>
<li>
<p><strong>Enable Static Sampling Mode on the EGM:</strong></p>
<ul>
<li>From Main Menu, press <code>2</code> (SET)</li>
<li>Press <code>3</code> (PMP) to access pump control</li>
<li>Current display shows &ldquo;SAMPLE PUMP ON / Y/OK N/CHANGE&rdquo;</li>
<li>Press <code>N</code> to change</li>
<li>Display now shows &ldquo;STATIC SAMPLING / Y/OK N/CHANGE&rdquo;</li>
<li>Press <code>Y</code> to confirm</li>
</ul>
</li>
<li>
<p><strong>Prepare for Injection on the EGM:</strong></p>
<ul>
<li>Press <code>1</code> (REC) to enter measurement mode</li>
<li>The EGM will show the current CO₂ concentration</li>
<li>Observe the baseline CO₂ concentration on your computer over time</li>
</ul>
</li>
<li>
<p><strong>Enable guided static workflow in open-egm4:</strong></p>
<ul>
<li>Press <code>m</code> on the monitor screen to enable Static Sampling mode</li>
<li>The stats panel should show <code>STATIC SAMPLING</code> and <code>STEP 1: INJECT SAMPLE (N)</code></li>
<li>Press <code>x</code> at any time to reset the cycle back to Step 1</li>
</ul>
</li>
<li>
<p><strong>Inject sample and acknowledge Step 1:</strong></p>
<ul>
<li>Draw sample into syringe (at least 5 ml is recommended for a stable reading)</li>
<li>Locate the gas out port on top of EGM and ensure that the female luer-lock adapter is securely connected</li>
<li>Attach the luer-lock syringe to the gas out port and inject sample</li>
<li>Press <code>n</code> immediately after injection to acknowledge Step 1 and start peak tracking</li>
</ul>
</li>
<li>
<p><strong>Capture settled value (Step 2):</strong></p>
<ul>
<li>Watch the concentration spike and then settle</li>
<li>Press <code>n</code> when the value has stabilized to capture the sample</li>
<li>Enter an optional sample label when prompted (leave blank for auto labels like &ldquo;Sample 1&rdquo;)</li>
<li>open-egm4 saves both:
<ul>
<li>the settled concentration (<code>sample_ppm</code>)</li>
<li>the highest concentration seen after injection (<code>sample_peak_ppm</code>)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Flush and reset (Step 3):</strong></p>
<ul>
<li>Inject ambient air into the EGM to flush the cell between samples</li>
<li>Press <code>n</code> to confirm flush and automatically return to Step 1 for the next sample</li>
</ul>
</li>
<li>
<p><strong>Data downloading and sample metadata:</strong></p>
<ul>
<li>Static sample events are stored <em>only</em> in the open-egm4 session on your computer</li>
<li>Export with <code>e</code> (open export screen), then <code>e</code> again to write CSV</li>
<li>CSV exports now include <code>type=SAMPLE</code> rows with:
<ul>
<li><code>sample_id</code></li>
<li><code>sample_label</code></li>
<li><code>sample_ppm</code> (settled value)</li>
<li><code>sample_peak_ppm</code> (post-injection peak)</li>
</ul>
</li>
<li>The CSV will still include normal second-by-second measurement rows for the full session</li>
</ul>
</li>
</ol>
<p><strong>Auto-Zero Warnings in Static Mode:</strong>
The EGM-4 will still perform automatic zeros even with pump off. You&rsquo;ll see warnings:</p>
<ul>
<li>&ldquo;AUTO ZERO IN 2 MINUTES&rdquo;</li>
<li>&ldquo;AUTO ZERO IN 1 MINUTE&rdquo;</li>
</ul>
<p>When zero begins, the pump turns on for ~15 seconds, then turns off again. This ensures an accurate baseline by passing air scrubbed of CO₂ by the soda lime to the IRGA, and setting its CO₂ concentration to 0 ppm.</p>
<div class="alert alert-Caution">
  Don&rsquo;t forget to re-enable the pump after you have run all of your samples.
</div>
<h2 id="troubleshooting-and-maintenance">Troubleshooting &amp; Maintenance<a hidden class="anchor" aria-hidden="true" href="#troubleshooting-and-maintenance">#</a></h2>
<div class="alert alert-Warning">
  Only open the unit if you feel comfortable with electronics. Static discharge can damage sensitive components. Ground yourself before poking around.
</div>
<h3 id="replacing-the-soda-lime-co-scrubber">Replacing the Soda Lime CO₂ Scrubber<a hidden class="anchor" aria-hidden="true" href="#replacing-the-soda-lime-co-scrubber">#</a></h3>
<p>The EGM needs to know what zero CO₂ looks like to make accurate measurements, and uses the soda lime to figure that out. Gradually, the granules in the soda lime column become saturated with CO₂ and can no longer absorb it, becoming pale in color as they do so. Replace when around 2/3 of the column have changed color.</p>
<p>To do this, unscrew the black cap on the back panel, pour out the old granules, and fill the column with fresh soda lime, leaving about an inch of space at the top. Replace the foam filter and cap.</p>
<div class="alert alert-Warning">
  Wash your hands after handling soda lime. It&rsquo;s caustic.
</div>
<h3 id="replacing-the-internal-battery">Replacing the Internal Battery<a hidden class="anchor" aria-hidden="true" href="#replacing-the-internal-battery">#</a></h3>
<p>The internal battery will need to be replaced after a few years of use. If you are unable to get more than 2 hours out of a single charge, the internal battery needs to be replaced.</p>
<ol>
<li><strong>Remove the fuse</strong>
<ul>
<li>On the back cover, slightly twist to remove the 1A fuse, and set it aside</li>
</ul>
</li>
<li><strong>Remove the main cover</strong>
<ul>
<li>Flip the EGM on it&rsquo;s back</li>
<li>Remove the 4 screws with a #1 Phillips screwdriver</li>
<li>Carefully lift the EGM out of the cover by lifting the front and rear top edges</li>
</ul>
</li>
<li><strong>Remove the back cover</strong>
<ul>
<li>On the back cover, remove the two screws on the left and right edge with a #1 Phillips screwdriver</li>
<li>Carefully lift the back cover away from the EGM by lowering the top of the cover, and leaning it away from the EGM</li>
<li>You&rsquo;ll need to tilt the rear cover until it&rsquo;s perpendicular to the EGM to remove it</li>
</ul>
</li>
<li><strong>Remove the front cover</strong>
<ul>
<li>Using a 5.0mm socket, remove the two nuts on the left and right edges of the front cover</li>
<li>Carefully lean the front cover away from the EGM, being sure to not stress the ribbons connecting it to the motherboard</li>
<li>The only reason to remove the front cover is to assist in removing the old internal battery, by pushing on it through the hole in the battery enclosure</li>
</ul>
</li>
<li><strong>Remove the internal battery</strong>
<ul>
<li>Disconnect the battery from the two leads by lightly pulling them away from the battery</li>
<li>Push on the battery from the hole in the enclosure, through the front panel, and out of the case</li>
</ul>
</li>
<li><strong>Install the new battery</strong>
<ul>
<li>Push the new battery into the enclosure, ensuring its seated properly</li>
<li>Connect the battery to the two leads by lightly pushing onto the contacts</li>
</ul>
</li>
<li><strong>Reassemble the front cover</strong>
<ul>
<li>Carefully lean the front cover back into place, being sure to not stress the ribbons connecting it to the motherboard</li>
<li>Using a 5.0mm socket, replace the two nuts on the left and right edges of the front cover</li>
</ul>
</li>
<li><strong>Reassemble the back cover</strong>
<ul>
<li>Carefully slide the back cover back into place, being sure to not stress the ribbons connecting it to the motherboard</li>
<li>On the back cover, replace the two screws on the left and right edge with a #1 Phillips screwdriver</li>
</ul>
</li>
<li><strong>Reassemble the main cover</strong>
<ul>
<li>Holding the EGM in the air upside down, position the main cover underneath it, and carefully lower it into place</li>
<li>Replace the 4 screws with a #1 Phillips screwdriver</li>
</ul>
</li>
<li><strong>Reassemble the fuse</strong>
<ul>
<li>On the back cover, slightly push and twist to replace the 1A fuse</li>
</ul>
</li>
</ol>
<h3 id="replacing-internal-tubing">Replacing internal tubing<a hidden class="anchor" aria-hidden="true" href="#replacing-internal-tubing">#</a></h3>
<p>Over time, the internal gas tubing will become aged and leak. You&rsquo;ll need to replace it with 1/8&quot; tubing, being careful not to create kinks or bends in the tubing. If you need 90 degree bends, some are available at McMaster-Carr (item number 5463K42).</p>
<h3 id="egm-4-error-codes">EGM-4 error codes<a hidden class="anchor" aria-hidden="true" href="#egm-4-error-codes">#</a></h3>
<p>The EGM-4 displays numbered error codes when problems occur:</p>
<p><strong>Error 01: Zero Too Low</strong></p>
<ul>
<li><strong>Cause</strong>: Soda lime exhausted, absorber column not seated, or valve failure</li>
<li><strong>Solution</strong>:
<ol>
<li>Replace the soda lime.</li>
<li>Ensure the soda lime cap is tight.</li>
</ol>
</li>
</ul>
<p><strong>Error 02: CO₂ &lt; 250 ppm</strong></p>
<ul>
<li><strong>Cause</strong>: Either genuine low CO₂ or same as Error 01</li>
<li><strong>Solution</strong>: If you&rsquo;re measuring ambient air (&gt;420 ppm), this indicates same problems as Error 01</li>
</ul>
<p><strong>Error 03: Analyzer Temperature &lt; 50°C</strong></p>
<ul>
<li><strong>Cause</strong>: Instrument too cold or thermostat failure</li>
<li><strong>Solution</strong>:
<ol>
<li>Allow longer warm-up time, or move somewhere warmer.</li>
</ol>
</li>
</ul>
<p><strong>Error 04: Analyzer Temperature &gt; 60°C</strong></p>
<ul>
<li><strong>Cause</strong>: Instrument overheating or thermostat failure</li>
<li><strong>Solution</strong>:
<ol>
<li>Turn off, allow to cool.</li>
<li>Check for ventilation blockage.</li>
</ol>
</li>
</ul>
<p><strong>Error 05: RH &gt; 90%</strong></p>
<ul>
<li><strong>Cause</strong>: High humidity or water in sample line</li>
<li><strong>Solution</strong>: In humid conditions, this may be normal.</li>
</ul>
<p><strong>Error 06: Battery Voltage Low</strong></p>
<ul>
<li><strong>Cause</strong>: Battery voltage &lt; 10.5V</li>
<li><strong>Solution</strong>: Recharge the battery. If problem persists, replace the battery.</li>
</ul>
<h3 id="software-connection-issues">Software Connection Issues<a hidden class="anchor" aria-hidden="true" href="#software-connection-issues">#</a></h3>
<ul>
<li><strong>&ldquo;command not found&rdquo;</strong>: Installation didn&rsquo;t complete. Try re-installing.</li>
<li><strong>&ldquo;No module named &lsquo;serial&rsquo;&rdquo;</strong>: Missing dependency—reinstall with <code>pip install pyserial</code></li>
</ul>
<p><strong>Can&rsquo;t connect to EGM-4:</strong></p>
<ul>
<li>Check the cables and make sure they&rsquo;re securely connected</li>
<li>Check EGM-4 is powered on</li>
<li>Verify you selected the correct serial port</li>
<li>Try a different serial port if multiple are available</li>
<li>On Linux: check permissions (<code>ls -l /dev/ttyUSB0</code> should show you have read access)</li>
</ul>
<h2 id="technical-appendix">Technical Appendix<a hidden class="anchor" aria-hidden="true" href="#technical-appendix">#</a></h2>
<h3 id="a-serial-protocol-specification">A: Serial Protocol Specification<a hidden class="anchor" aria-hidden="true" href="#a-serial-protocol-specification">#</a></h3>
<p>The EGM-4 communicates over RS-232 serial at 9600 baud, 8 data bits, no parity, 1 stop bit, and no flow control. This is a standard configuration supported by virtually all serial terminal software.</p>
<p>Each data record is exactly 61 characters long (1 letter followed by 60 digits), with no spaces or delimiters, terminated by a carriage return and line feed (<code>\r\n</code>). The manual refers to &ldquo;60 digits&rdquo; which excludes the initial M/R mode character. During live measurements, the EGM transmits one record per second. When dumping stored data, all records are sent consecutively.</p>
<p>Here&rsquo;s an example raw record:</p>
<p><code>R000002180313170042900000000000000000000000000400000000096508</code></p>
<p>The table below shows how to interpret parsed records. Both real-time measurements (<code>M</code>) and stored records (<code>R</code>) use the same format:</p>
<table>
  <thead>
      <tr>
          <th>M/R</th>
          <th>Plot No.</th>
          <th>Rec No</th>
          <th>Day</th>
          <th>Mo</th>
          <th>Hr</th>
          <th>Min</th>
          <th>CO₂ Ref</th>
          <th>H₂O Ref</th>
          <th>RHT</th>
          <th>A</th>
          <th>B</th>
          <th>C</th>
          <th>D</th>
          <th>E</th>
          <th>F</th>
          <th>G</th>
          <th>H</th>
          <th>AP</th>
          <th>PT</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>M</td>
          <td>1</td>
          <td>1</td>
          <td>28</td>
          <td>1</td>
          <td>13</td>
          <td>19</td>
          <td>968</td>
          <td>0</td>
          <td>000.0</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>00</td>
          <td>00</td>
          <td>991</td>
          <td>0</td>
      </tr>
      <tr>
          <td>R</td>
          <td>1</td>
          <td>2</td>
          <td>28</td>
          <td>1</td>
          <td>13</td>
          <td>21</td>
          <td>930</td>
          <td>0</td>
          <td>000.0</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>0000</td>
          <td>00</td>
          <td>00</td>
          <td>991</td>
          <td>0</td>
      </tr>
  </tbody>
</table>
<p>The fixed columns are:</p>
<table>
  <thead>
      <tr>
          <th>Column</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>M/R</td>
          <td>M = real-time measurement, R = record retrieved from memory</td>
      </tr>
      <tr>
          <td>Plot No</td>
          <td>Plot number, 0-99</td>
      </tr>
      <tr>
          <td>Rec No</td>
          <td>Record number within the plot, 1-9999</td>
      </tr>
      <tr>
          <td>Day</td>
          <td>Day of month, 1-31</td>
      </tr>
      <tr>
          <td>Mo</td>
          <td>Month, 1-12</td>
      </tr>
      <tr>
          <td>Hr</td>
          <td>Hour in 24-hour format, 0-23</td>
      </tr>
      <tr>
          <td>Min</td>
          <td>Minute, 0-59</td>
      </tr>
      <tr>
          <td>CO₂ Ref</td>
          <td>CO₂ concentration in ppm (equivalent to µmol mol⁻¹)</td>
      </tr>
      <tr>
          <td>H₂O Ref</td>
          <td>Water vapor in millibars (only if optional RH sensor is fitted)</td>
      </tr>
      <tr>
          <td>RHT</td>
          <td>Temperature from RH sensor in °C (if sensor is fitted)</td>
      </tr>
      <tr>
          <td>A-H</td>
          <td>Probe-specific fields (see probe type table below)</td>
      </tr>
      <tr>
          <td>AP</td>
          <td>Atmospheric pressure in millibars</td>
      </tr>
      <tr>
          <td>PT</td>
          <td>Probe type code, 0-11</td>
      </tr>
  </tbody>
</table>
<p>Columns A through H contain probe-specific data whose meaning depends on the connected sensor:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Sensor</th>
          <th>A</th>
          <th>B</th>
          <th>C</th>
          <th>D</th>
          <th>E</th>
          <th>F</th>
          <th>G</th>
          <th>H</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>No Sensor (stand-alone)</td>
          <td>mV Pin 1</td>
          <td>mV Pin 2</td>
          <td>mV Pin 3</td>
          <td>mV Pin 4</td>
          <td>mV Pin 5</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>1</td>
          <td>STP-1 Soil Temp</td>
          <td>PAR</td>
          <td>%RH</td>
          <td>Temp</td>
          <td>—</td>
          <td>mV Pin 5</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>2</td>
          <td>HTR-2 %RH/Temp/PAR</td>
          <td>PAR</td>
          <td>%RH</td>
          <td>Temp</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>3</td>
          <td>HTR-1 %RH/Temp/LUX</td>
          <td>PAR</td>
          <td>%RH</td>
          <td>Temp</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>7</td>
          <td>PMR-4 Porometer</td>
          <td>PAR</td>
          <td>%RH In</td>
          <td>Temp</td>
          <td>%RH Out</td>
          <td>Flow</td>
          <td>GS</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>8</td>
          <td>SRC-1 Soil Respiration</td>
          <td>PAR</td>
          <td>%RH</td>
          <td>Temp</td>
          <td>DC</td>
          <td>DT</td>
          <td>SR Rate</td>
          <td>—</td>
          <td>+/- SR Rate</td>
      </tr>
      <tr>
          <td>10</td>
          <td>50Y %RH/Temp</td>
          <td>—</td>
          <td>%RH</td>
          <td>Temp</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
          <td>—</td>
      </tr>
      <tr>
          <td>11</td>
          <td>CFX-1 / CPY-3</td>
          <td>PAR</td>
          <td>Evap Rate</td>
          <td>Temp</td>
          <td>DC</td>
          <td>Flow</td>
          <td>SR Rate</td>
          <td>Flow Mult.</td>
          <td>+/- SR Rate</td>
      </tr>
  </tbody>
</table>
<p>The units for each data type are:</p>
<table>
  <thead>
      <tr>
          <th>Output Data</th>
          <th>Units</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>PAR</td>
          <td>µmol m⁻² s⁻¹</td>
      </tr>
      <tr>
          <td>%RH</td>
          <td>%</td>
      </tr>
      <tr>
          <td>Evap Rate</td>
          <td>mmol m⁻² s⁻¹ × 1000</td>
      </tr>
      <tr>
          <td>Temperature</td>
          <td>°C</td>
      </tr>
      <tr>
          <td>Flow</td>
          <td>ml min⁻¹</td>
      </tr>
      <tr>
          <td>GS</td>
          <td>mmol (H₂O) m⁻² s⁻¹ (Stomatal Conductance)</td>
      </tr>
      <tr>
          <td>SR Rate</td>
          <td>g CO₂ m⁻² hr⁻¹ for SRC-1; µmol m⁻² s⁻¹ for CPY-3 and CFX-1</td>
      </tr>
      <tr>
          <td>DC</td>
          <td>ppm (change in CO₂ concentration)</td>
      </tr>
      <tr>
          <td>DT</td>
          <td>seconds (change in time)</td>
      </tr>
      <tr>
          <td>+/-</td>
          <td>00 = respiration (CO₂ increase), 01 = uptake (CO₂ decrease)</td>
      </tr>
  </tbody>
</table>
<div class="alert alert-Note">
  For CFX-1/CPY-3, column G contains a flow multiplier (1 or 10) that should be applied to get the true flow rate.
</div>
<p>Here&rsquo;s a Python function that parses a raw 61-character record:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Args:
</span></span><span style="display:flex;"><span>    raw (str): The raw serial string (e<span style="color:#f92672">.</span>g<span style="color:#f92672">.</span>, <span style="color:#e6db74">&#39;R00000...&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Returns:
</span></span><span style="display:flex;"><span>    dict: Key<span style="color:#f92672">-</span>value pairs of parsed sensor data<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Ensure the string is the expected length after stripping newlines
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">clean = raw.strip()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">if len(clean) != 61:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    raise ValueError(f&#34;Invalid record length: {len(clean)} characters&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">return {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;mode&#39;: clean[0],             # M (Real-time measurement) or R (Stored record)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;plot&#39;: int(clean[1:3]),      # Plot Number
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;record_num&#39;: int(clean[3:7]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;timestamp&#39;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;day&#39;: int(clean[7:9]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;month&#39;: int(clean[9:11]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;hour&#39;: int(clean[11:13]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;minute&#39;: int(clean[13:15]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;co2_ppm&#39;: int(clean[15:19]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;h2o_mb&#39;: int(clean[19:23]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;temperature_c&#39;: float(clean[23:28]) / 10.0, # Fixed point div by 10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # ... (Sensors A-H mapped as integer counts) ...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;pressure_mb&#39;: int(clean[56:59]),
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;probe_type&#39;: int(clean[59:61])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Beyond data records, the EGM-4 also sends status messages during startup and operation. A boot message takes the form <code>B,EGM4,&lt;serial&gt;,&lt;firmware&gt;</code> and provides the device&rsquo;s serial number and firmware version. During warmup, you&rsquo;ll see <code>W,TT</code> messages where TT indicates the current cell temperature. The instrument sends <code>I,NN</code> during initialization and <code>Z,NN</code> during zeroing, where NN is a countdown counter. Diagnostic messages beginning with <code>D,</code> contain internal state information documented in the manual on page 38.</p>
<h3 id="b-flux-calculation-methods">B: Flux Calculation Methods<a hidden class="anchor" aria-hidden="true" href="#b-flux-calculation-methods">#</a></h3>
<p>The EGM-4 calculates soil respiration flux by monitoring the rate of CO₂ accumulation inside the closed SRC-1 chamber. The fundamental equation derived from the Ideal Gas Law is:</p>
<p>\[F = \frac{dC}{dt} \times \frac{V}{A} \times \frac{P}{R \times T}\]</p>
<p>Where:</p>
<ul>
<li>\(F\) is the CO₂ flux in g CO₂ m⁻² hr⁻¹.</li>
<li>\(\frac{dC}{dt}\) is the rate of change in CO₂ concentration (ppm s⁻¹).</li>
<li>\(V\) is the total system volume (chamber + tubing).</li>
<li>\(A\) is the soil surface area enclosed by the chamber.</li>
<li>\(\frac{P}{RT}\) converts the concetration change to molar units.</li>
</ul>
<h4 id="linear-vs-dot-quadratic">Linear vs. Quadratic<a hidden class="anchor" aria-hidden="true" href="#linear-vs-dot-quadratic">#</a></h4>
<p>When you start a measurement using the SRC-1, you&rsquo;ll be prompted to select the fitting method: <code>1LINEAR 2QUAD?</code>. This selection determines how the EGM calculates the slope (\(\frac{dC}{dt}\)) from the raw concentration data.</p>
<p><strong>1. Linear Fit (<code>1</code>):</strong> This method assumes that the accumulation is a straight line (\(C = C_0 + kt\)). You should choose it for short measurement periods, typically under 2 minutes, or low-flux soils.</p>
<p><strong>2. Quadratic Fit (<code>2</code>):</strong> As CO₂ accumulates in the chamber, the concentration gradient decreases, causing the flux rate to slow down or level off. This method accounts for this by fitting a curve to the data (\(C = C_0 + kt + ct^2\)).</p>
<div class="alert alert-Warning">
  If you select Quadratic fit and the curvature is excessive (specifically, if the quadratic term \(ct\) exceeds 20% of the linear term \(b\)), the EGM will yell <code>NON LINEAR FIT</code>. This indicates a significant leak or chamber saturation.
</div>
<h4 id="chamber-corrections">Chamber Corrections<a hidden class="anchor" aria-hidden="true" href="#chamber-corrections">#</a></h4>
<p>For the SRC-1, the default chamber volume is 1171 ml with a soil contact area of 78.5 cm² (corresponding to the 10 cm diameter opening). Tubing typically adds 50–100 ml to the total volume. If you&rsquo;re using a custom chamber setup, calculate the total volume as the chamber volume plus the tubing volume, where tubing volume can be calculated as \(V_{tubing} = \pi r^2 L\) with \(r\) being the internal radius and \(L\) the total length in centimeters.</p>
<p>Temperature should really be measured inside the chamber using the RH/Temp sensor or an STP-1 probe, because the sample air temperature directly affects the flux calculation.</p>
<p>The EGM-4 measures atmospheric pressure internally and applies corrections automatically. At higher elevations, pressure drops significantly: approximately 900 mb at 1000 m and 800 mb at 2000 m compared to 1013 mb at sea level. This affects how many CO₂ molecules occupy a given volume.</p>
<h4 id="worked-example">Worked Example<a hidden class="anchor" aria-hidden="true" href="#worked-example">#</a></h4>
<p>Flux is measured by placing a closed chamber on the soil and monitoring the rate of CO₂ concentration increase inside the chamber. Assuming a well-mixed, sealed system:</p>
<p>\[R = \frac{(C_n - C_0)}{T_n} \times \frac{V}{A}\]</p>
<p>where \(R\) is the flux (CO₂ per unit area per unit time), \(C_0\) is the initial CO₂ concentration, \(C_n\) is the concentration after time \(T_n\), \(V\) is the total system volume, and \(A\) is the exposed soil area.</p>
<p>Over short measurement periods with small concentration changes relative to soil CO₂ levels, flux should be constant, giving a linear concentration increase. However, any chamber leakage causes the apparent flux to decrease with time, producing a curved response. Fitting a quadratic equation \(C = a + bT + cT^2\) between concentration and time allows extraction of the true initial flux rate.</p>
<p>Since \(\frac{dC}{dT} = b + 2cT\), at time \(T = 0\) we have \(\frac{dC}{dT} = b\). This gives the instantaneous flux rate before leakage effects accumulate and become a problem. Comparing the magnitude of \(cT\) to \(b\) indicates leakage severity—the EGM will yell <code>NON LINEAR FIT</code> at you if \(cT\) exceeds 20% of \(b\).</p>
<p>From the basic equation, \(R = b \times \frac{V}{A}\). To express flux in mass per unit area per unit time, the rate \(b\) must be in mass per unit volume. The CO₂ analyzer measures volume/volume ratio (ppm by volume = µL/L = µbar/bar = µmol/mol).</p>
<p>One kilogram-mole of gas (44.01 kg of CO₂) occupies 22.41 m³ at STP. The full conversion equation is:</p>
<p>\[R = b \times \frac{P}{1000} \times \frac{273}{273 + T_a} \times \frac{44.01}{22.41} \times \frac{V}{A}\]</p>
<p>where \(R\) is flux in kg m⁻² s⁻¹, \(b\) is measured as ppm s⁻¹, \(P\) is atmospheric pressure in mb, \(T_a\) is air temperature in °C, \(V\) is system volume in m³, and \(A\) is exposed area in m².</p>
<p>In practice, the EGM measures \(\frac{dC}{dt}\) in ppm/second, \(V\) in cm³, and \(A\) in cm². Results are expressed as g m⁻² hr⁻¹. To convert g m⁻² hr⁻¹ to µmol m⁻² s⁻¹, multiply by 6.312.</p>
<p><strong>Environmental correction notes:</strong></p>
<p><em>Water Vapor:</em> Adding water vapor to dry air dilutes the CO₂ concentration because the total air volume increases. From an infrared measurement perspective, water vapor induces a slight increase in CO₂ absorption (foreign gas broadening) that approximately cancels the dilution effect. The net result is that the analyzer reports approximately the dry-gas concentration.</p>
<p><em>Atmospheric Pressure:</em> Increased pressure raises concentration according to the Gas Law, but infrared absorption increases more than expected due to pressure broadening of absorption bands. The approximate correction is:</p>
<p>\[C = C_M \times \frac{1000}{0.75P + 0.00025P^2}\]</p>
<p>where \(C\) is the concentration that would be measured at 1000 mb and \(C_M\) is the concentration measured at \(P\) mb.</p>
<p><em>Air Temperature:</em> With the EGM&rsquo;s thermostatted detector at 45°C, the primary temperature effect is on gas density, following the Gas Law (approximately −0.3% per °C increase). The correction referenced to calibration at 0°C is:</p>
<p>\[C = C_M \times \frac{273 + T_a}{273}\]</p>
<p>When all corrections are applied, the complete equation becomes:</p>
<p>\[R = b \times \frac{1000}{1000} \times \frac{1000}{P(0.75 + 0.00025P)} \times \frac{273 + T_a}{273} \times \frac{273}{273 + T_a} \times \frac{44.01}{22.41} \times \frac{V}{A}\]</p>
<p>Simplifying:</p>
<p>\[R = \frac{b \times 44.01 \times V}{(0.75 + 0.00025P) \times 22.41 \times A}\]</p>
<p>The temperature corrections cancel, and the pressure effect is small. When calibrating at high altitude, the simplified form uses average atmospheric pressure at that altitude:</p>
<p>\[R = b \times \frac{P_{av}}{1000} \times \frac{44.01}{22.41} \times \frac{V}{A}\]</p>
<div class="alert alert-Note">
  Measurement accuracy can be compromised by chamber leaks (which typically cause underestimation), temperature gradients inside the chamber (like being exposed to direct sunlight), pressure fluctuations from wind or weather changes, and non-representative soil coverage due gaps in the collar seal. Make sure your Blue Tack is firmly pressed into place and isn&rsquo;t leaving any holes.
</div>
<h3 id="c-probe-types-reference--0-11">C: Probe Types Reference (0-11)<a hidden class="anchor" aria-hidden="true" href="#c-probe-types-reference--0-11">#</a></h3>
<p>The EGM-4 automatically identifies connected sensors by reading a code resistor on Pin 1 of the 15-pin connector. When you power on the device with a sensor attached, the startup screen displays &ldquo;PROBETYPE X&rdquo; where X is the detected type number from the table below:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Sensor/Probe</th>
          <th>Code Resistor</th>
          <th>Typical Use</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>No sensor</td>
          <td>None</td>
          <td>Stand-alone CO₂ analyzer</td>
      </tr>
      <tr>
          <td>1</td>
          <td>STP-1 Soil Temperature</td>
          <td>100 kΩ</td>
          <td>Soil temperature logging</td>
      </tr>
      <tr>
          <td>2</td>
          <td>HTR-2 RH/Temp/PAR</td>
          <td>56 kΩ</td>
          <td>Environmental monitoring</td>
      </tr>
      <tr>
          <td>3</td>
          <td>HTR-1 RH/Temp/PAR</td>
          <td>36 kΩ</td>
          <td>Environmental monitoring (legacy)</td>
      </tr>
      <tr>
          <td>4</td>
          <td>PAR-1 Light Sensor</td>
          <td>27 kΩ</td>
          <td>PAR (photosynthetically active radiation)</td>
      </tr>
      <tr>
          <td>5</td>
          <td>PAR-1 LUX</td>
          <td>20 kΩ</td>
          <td>Light intensity in lux</td>
      </tr>
      <tr>
          <td>6</td>
          <td>SRM-1</td>
          <td>15 kΩ</td>
          <td>Solarimeter</td>
      </tr>
      <tr>
          <td>7</td>
          <td>PMR-4 Porometer</td>
          <td>User-set</td>
          <td>Leaf stomatal conductance</td>
      </tr>
      <tr>
          <td>8</td>
          <td>SRC-1 Soil Respiration</td>
          <td>9.1 kΩ</td>
          <td>Closed-system soil CO₂ flux</td>
      </tr>
      <tr>
          <td>9</td>
          <td>RH/T/O₂</td>
          <td>20 kΩ</td>
          <td>Humidity, temp, oxygen</td>
      </tr>
      <tr>
          <td>10</td>
          <td>50Y RH/Temperature</td>
          <td>5.6 kΩ</td>
          <td>Humidity and temperature only</td>
      </tr>
      <tr>
          <td>11</td>
          <td>CFX-1 / CPY-3</td>
          <td>4.3 kΩ</td>
          <td>Open-system flux chambers</td>
      </tr>
  </tbody>
</table>
<p>For Type 2, 3, and 10 sensors, the raw millivolt readings can be converted to physical units using these relationships: PAR equals the millivolt reading multiplied by 3 (giving µmol m⁻² s⁻¹), relative humidity equals the millivolt reading divided by 10 (giving percent), and temperature equals the millivolt reading divided by 20 (giving °C).</p>
<p>If you&rsquo;re using non-PP-Systems sensors or need to override auto-detection (for Type 0 or 7), you can manually set the probe type through Menu 2 (SET), then option 1 (EGM), where you select stand-alone mode, probe mode, or porometer mode.</p>
<p>Custom sensors can be connected to the I/O ports, which accept 0–1V input signals. The readings appear as millivolt values (0–1000 mV) in the A through E fields of data records. When using custom sensors, ensure your output is scaled to the 0–1V range and apply your own conversion factors during post-processing.</p>
<h3 id="d-water-vapor-and-temperature-corrections">D: Water Vapor &amp; Temperature Corrections<a hidden class="anchor" aria-hidden="true" href="#d-water-vapor-and-temperature-corrections">#</a></h3>
<p>CO₂ measurements are affected by both water vapor and temperature. The EGM-4 applies corrections automatically when appropriate sensors are connected, but understanding these effects helps in troubleshooting anomalous readings.</p>
<p>Water vapor dilutes the mole fraction of CO₂ in air. The relationship between wet and dry CO₂ concentrations is:</p>
<p>\[C_{dry} = \frac{C_{wet}}{1 - \frac{e}{P}}\]</p>
<p>Here, \(C_{dry}\) is the CO₂ concentration in dry air (ppm), \(C_{wet}\) is the measured concentration in humid air, \(e\) is water vapor pressure in millibars, and \(P\) is total atmospheric pressure in millibars.</p>
<p>As a practical example: if you measure 400 ppm CO₂ in air with 20 mb of water vapor at 1013 mb total pressure, the correction factor is \(1 - (20/1013) = 0.980\), giving a dry-air equivalent of \(400 / 0.980 = 408\) ppm. The EGM-4 applies this correction automatically when an RH/Temp sensor is connected; without the sensor, no correction is applied.</p>
<p>Temperature affects CO₂ measurements in several ways. Colder air has higher gas density (more molecules per unit volume), detector sensitivity varies with temperature, and temperature is a direct input to flux calculations. To minimize temperature effects on the IRGA itself, the EGM-4 thermostatically maintains the sample cell at 55°C.</p>
<p>For best results, always use an RH/Temp sensor for accurate measurements, record the temperature inside the chamber (using an STP-1 if available) for flux calculations, and expect 2–4% corrections to CO₂ values when humidity exceeds 90%.</p>
<h3 id="e-chamber-volume-calculations">E: Chamber Volume Calculations<a hidden class="anchor" aria-hidden="true" href="#e-chamber-volume-calculations">#</a></h3>
<p>Accurate flux measurements depend on knowing the total system volume, which includes both the chamber and all connecting tubing. For the SRC-1, the manufacturer specifies a chamber volume of 1171 ml. Adding the standard tubing (typically 50–100 ml depending on length) gives a total system volume of roughly 1220–1270 ml.</p>
<p>For cylindrical chambers, volume is calculated as \(V = \pi r^2 h\), where \(r\) is the radius and \(h\) is the height, both in centimeters, yielding volume in cubic centimeters (equivalent to milliliters). Tubing volume uses the same formula: \(V_{tube} = \pi r^2 L\), where \(L\) is the total tubing length.</p>
<p>As an example, 1/8&quot; inner diameter tubing has an internal diameter of 3.175 mm, or a radius of 0.15875 cm. For 100 cm of this tubing, the volume is \(\pi \times (0.15875)^2 \times 100 = 7.9\) ml.</p>
<p>The soil contact area is similarly calculated as \(A = \pi r^2\). For the SRC-1 with its 10 cm diameter opening, this gives \(A = \pi \times 5^2 = 78.5\) cm².</p>
<p>To enter custom volume and area values in the EGM-4, press 1 (REC) from the Main Menu, then press N at the settings screen to modify values. Press 1 to change volume or 2 to change area, enter your new values, and the EGM-4 will automatically update the V/A ratio used in flux calculations.</p>
<p>The volume-to-area ratio determines how quickly CO₂ accumulates for a given flux rate. A high V/A ratio means slower accumulation and longer measurement times, while a low V/A ratio results in faster accumulation. For soil respiration work, typical V/A ratios are around 15 cm; the SRC-1 default is 14.9 cm.</p>
<h3 id="f-open-egm4-software-design-philosophy">F: open-egm4 Software Design Philosophy<a hidden class="anchor" aria-hidden="true" href="#f-open-egm4-software-design-philosophy">#</a></h3>
<p>This section explains why open-egm4 was built as a terminal user interface (TUI) and how the software works internally.</p>
<h4 id="why-a-terminal-interface">Why a Terminal Interface?<a hidden class="anchor" aria-hidden="true" href="#why-a-terminal-interface">#</a></h4>
<p>I deliberately chose to use a text-based interface instead of a graphical interface for several reasons.</p>
<p>Chiefly, keep it simple, stupid. Additionally, it makes cross-platform support automatic, while the previous PP Systems software was Windows-only. It also eliminates dependencies on GUI toolkits, which can be a pain to install and maintain. It allows for remote access via SSH, which could theoretically be useful. I guess. A terminal interface is inherently scriptable and automatable, and it&rsquo;s much easier to fix if something goes wrong.</p>
<h4 id="advantages-over-legacy-windows-software">Advantages Over Legacy Windows Software<a hidden class="anchor" aria-hidden="true" href="#advantages-over-legacy-windows-software">#</a></h4>
<p>The official PP Systems software is Windows-only and has several limitations. It requires specific .NET framework versions that may conflict with other software, offers no remote access capability, and is closed-source. It also is no longer maintained.</p>
<p>Open-egm4 meets and exceeds all of the featues that the official software has to offer.</p>
<p>Open-egm4 addresses all of these concerns. It runs on any operating system, is open source under the MIT license, and is actively developed and maintained. The community can contribute features, and it works seamlessly over SSH for remote field sites.</p>
<p><strong>Architecture Overview:</strong></p>
<p>Open-egm4 is built in Python using the <a href="https://textual.textualize.io/">Textual</a> framework for terminal UI rendering.</p>
<p>The core serial communication lives in <code>src/egm_interface.py</code>, which defines the <code>EGM4Serial</code> class. This class manages the connection to the EGM-4 via pyserial, parses the incoming 61-character fixed-width data records using position-based slicing, and dispatches parsed data to registered callbacks. The parser handles all probe types (0-11) and extracts fields like CO₂, temperature, humidity, and calculated flux depending on the connected sensor.</p>
<p>Session persistence is handled by <code>src/database.py</code>, which uses SQLite to store readings across sessions. This allows users to close the app and resume later without losing data. The database stores each reading with its timestamp, plot number, channel values, and session metadata.</p>
<p>The TUI itself is composed of screens and widgets in the <code>src/tui/</code> directory. The main application entry point is <code>src/tui/app.py</code>, which sets up the Textual app and manages screen transitions. Key screens include the connection screen (<code>screens/connect.py</code>), the main monitor screen (<code>screens/monitor.py</code>), the export wizard (<code>screens/export.py</code>), and big mode (<code>screens/big_mode.py</code>).</p>
<p>The monitor screen orchestrates real-time display by wiring the serial handler to the chart widget (<code>widgets/co2_chart.py</code>), which renders data using <a href="https://github.com/piccolomo/plotext">plotext</a> for ASCII plotting. Statistics are calculated and displayed by <code>widgets/stats.py</code>, and the channel legend is managed by <code>widgets/legend.py</code>.</p>
<p>Export functionality converts session data to CSV format, allowing users to filter by plot number and date range before saving.</p>
<p><strong>Data Flow:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+----------+     +------------+     +------------------+
</span></span><span style="display:flex;"><span>|  EGM-4   | --&gt; | EGM4Serial | --&gt; |     Parser       |
</span></span><span style="display:flex;"><span>+----------+     +------------+     +------------------+
</span></span><span style="display:flex;"><span>                                            |
</span></span><span style="display:flex;"><span>                                      (Parsed Dict)
</span></span><span style="display:flex;"><span>                                            v
</span></span><span style="display:flex;"><span>                              +-------------------------+
</span></span><span style="display:flex;"><span>                              |  Textual Event Loop     |
</span></span><span style="display:flex;"><span>                              +-------------------------+
</span></span><span style="display:flex;"><span>                                    /           \
</span></span><span style="display:flex;"><span>                                   v             v
</span></span><span style="display:flex;"><span>                      +------------+         +-----------------+
</span></span><span style="display:flex;"><span>                      |  Database  |         | MonitorScreen   |
</span></span><span style="display:flex;"><span>                      +------------+         +-----------------+
</span></span><span style="display:flex;"><span>                            |                  /      |      \
</span></span><span style="display:flex;"><span>                            v               CO2    Stats   Legend
</span></span><span style="display:flex;"><span>                      +------------+       Chart
</span></span><span style="display:flex;"><span>                      | SQLite DB  |
</span></span><span style="display:flex;"><span>                      +------------+
</span></span></code></pre></div><p><em>Created in Doom Emacs 2.0.9, using org-mode 9.7.</em></p>
<p><em>Written in January 2026.</em></p>
<p>Created by Morgan Salisbury 😊🐇⛵️🏔️❤️</p>


            </div>

            <footer class="post-footer">
                <ul class="post-tags">
                </ul>
            </footer>
        </article>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sidebar = document.getElementById('toc-sidebar');
        const mobileBar = document.getElementById('toc-mobile-bar');
        const mobileToggle = document.getElementById('toc-mobile-toggle');
        const mobileNav = document.getElementById('toc-mobile-nav');
        const mobileCurrent = document.getElementById('toc-mobile-current');
        const mobileParent = document.getElementById('toc-mobile-parent');

        if (!sidebar && !mobileBar) return;

        const markers = sidebar ? sidebar.querySelectorAll('.toc-marker') : [];
        const tocLinks = sidebar ? sidebar.querySelectorAll('.toc-nav a') : [];
        const currentLabel = document.getElementById('toc-current-label');
        const mobileLinks = mobileBar ? mobileBar.querySelectorAll('.toc-mobile-item a') : [];
        const headings = [];

        
        if (markers.length > 0) {
            markers.forEach((marker, i) => {
                const id = marker.dataset.target.slice(1);
                const heading = document.getElementById(id);
                const title = marker.dataset.title;
                const level = parseInt(marker.dataset.level);
                if (heading) {
                    headings.push({ element: heading, marker: marker, link: tocLinks[i], title: title, level: level });
                }
            });
        } else if (mobileLinks.length > 0) {
            mobileLinks.forEach((link, i) => {
                const href = link.getAttribute('href');
                const id = href.slice(1);
                const heading = document.getElementById(id);
                const title = link.textContent.trim();
                const level = parseInt(link.closest('.toc-mobile-item').dataset.level);
                if (heading) {
                    headings.push({ element: heading, link: link, title: title, level: level });
                }
            });
        }

        
        if (mobileToggle) {
            mobileToggle.addEventListener('click', function () {
                mobileBar.classList.toggle('open');
            });
        }

        
        if (mobileNav) {
            mobileNav.addEventListener('click', function (e) {
                if (e.target.tagName === 'A') {
                    mobileBar.classList.remove('open');
                }
            });
        }

        function updateActiveState() {
            const scrollPos = window.scrollY + 150;
            let current = headings[0];
            let currentIndex = 0;

            for (let i = 0; i < headings.length; i++) {
                if (headings[i].element.offsetTop <= scrollPos) {
                    current = headings[i];
                    currentIndex = i;
                }
            }

            
            if (sidebar) {
                markers.forEach(m => m.classList.remove('active'));
                tocLinks.forEach(l => l.classList.remove('active'));

                if (current) {
                    if (current.marker) current.marker.classList.add('active');
                    if (current.link) current.link.classList.add('active');

                    if (currentLabel) {
                        
                        let breadcrumbs = [];
                        let targetLevel = current.level;

                        
                        for (let j = currentIndex - 1; j >= 0; j--) {
                            if (headings[j].level < targetLevel) {
                                breadcrumbs.unshift(headings[j].title);
                                targetLevel = headings[j].level;
                            }
                            if (targetLevel <= 2) break;
                        }

                        
                        let html = '';
                        if (breadcrumbs.length > 0) {
                            html += `<span class="toc-parent-label">${breadcrumbs.join(' › ')}</span>`;
                        }
                        html += `<span class="toc-child-label">${current.title}</span>`;
                        currentLabel.innerHTML = html;

                        const markerRect = current.marker.getBoundingClientRect();
                        const sidebarRect = sidebar.getBoundingClientRect();
                        currentLabel.style.top = (markerRect.top - sidebarRect.top + markerRect.height / 2 - (breadcrumbs.length > 0 ? 18 : 10)) + 'px';
                    }
                }
            }

            
            if (mobileBar && current) {
                
                if (scrollPos > 200) {
                    mobileBar.classList.add('visible');
                } else {
                    mobileBar.classList.remove('visible');
                    mobileBar.classList.remove('open');
                }

                
                let breadcrumbs = [];
                let targetLevel = current.level;
                for (let j = currentIndex - 1; j >= 0; j--) {
                    if (headings[j].level < targetLevel) {
                        breadcrumbs.unshift(headings[j].title);
                        targetLevel = headings[j].level;
                    }
                    if (targetLevel <= 2) break;
                }

                if (mobileCurrent) mobileCurrent.textContent = current.title;
                if (mobileParent) mobileParent.textContent = breadcrumbs.length > 0 ? breadcrumbs.join(' › ') : '';

                
                mobileLinks.forEach(l => l.classList.remove('active'));
                const activeLink = mobileBar.querySelector(`a[href="#${current.element.id}"]`);
                if (activeLink) activeLink.classList.add('active');
            }
        }

        window.addEventListener('scroll', updateActiveState);
        updateActiveState();
    });
</script>
    </main>
    
<footer class="footer">
    <span>&copy; 2026 </span> · 

    <span>
        Love from Kansas · Created with Emacs
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
